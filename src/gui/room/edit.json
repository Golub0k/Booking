{
  "@title": "Редактирование помещения",
  "@preload": {
    "room": {
      "$apply-func": {
        "func": "return transformRoomArray(room); function transformRoomArray(room) { const additional_services = room.additional_services.filter(element => element.additionalService.state !== \"deleted\").map(element => element.additionalService); const equipments = room.equipments.map(element => element.equipment); const furniture = room.furniture.map(element => element.furniture); return {...room, additional_services, equipments, furniture}; }",
        "args": {
          "room": {
            "$from-context": {
              "path": "$response.body.data.items.0",
              "data": {
                "$api-data": {
                  "query": "room/get",
                  "id": {
                    "$query-params": {
                      "name": "id"
                    }
                  },
                  "options": {
                    "observe": "response"
                  },
                  "variables": {
                    "id": {
                      "$query-params": {
                        "name": "id"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "booking": {
      "$array-filter": {
        "array": {
          "$from-context": {
            "path": "$response.body.data.items",
            "data": {
              "$api-data": {
                "query": "booking/get_to_check",
                "id": {
                  "$query-params": {
                    "name": "id"
                  }
                },
                "options": {
                  "observe": "response"
                },
                "variables": {
                  "dateNow": {
                    "$datetime-now": {}
                  }
                },
                "errors": {
                  "default": {
                    "$message": {
                      "severity": "error",
                      "summary": "Ошибка",
                      "detail": "При загрузке данных произошла ошибка, повторите попытку позднее"
                    }
                  }
                }
              }
            }
          }
        },
        "filter": {
          "$in": {
            "value": {
              "$query-params": {
                "name": "id"
              }
            },
            "array": {
              "$array-pluck": {
                "array": {
                  "$from-context": {
                    "path": "$data.rooms"
                  }
                },
                "key": "roomId"
              }
            }
          }
        }
      }
    }
  },
  "type": "object",
  "model": "#data",
  "widget": {
    "name": "container"
  },
  "properties": {
    "breadcrumbs": {
      "type": "object",
      "widget": {
        "name": "breadcrumb",
        "mobileItems": [
          {
            "label": "Реестр помещений",
            "routerLink": "/cabinet/room/list"
          }
        ],
        "items": [
          {
            "label": "Главная",
            "routerLink": "/cabinet/event/list"
          },
          {
            "label": "Реестр помещений",
            "routerLink": "/cabinet/room/list"
          },
          {
            "label": {
              "$from-context": {
                "path": "@preload.room.name"
              }
            },
            "routerLink": "/cabinet/room/view",
            "queryParams": {
              "id": {
                "$query-params": {
                  "name": "id"
                }
              }
            }
          },
          {
            "label": "Редактирование помещения"
          }
        ],
        "class": {
          "group": "p-xs-auto mrg-lg-b-xl mrg-b-md"
        }
      }
    },
    "modals": {
      "model": false,
      "type": "object",
      "widget": "container",
      "properties": {
        "selectServices": {
          "type": "object",
          "model": "#modalSelectServices",
          "widget": {
            "name": "dialog",
            "options": {
              "visible": false,
              "closable": true
            }
          },
          "properties": {
            "content": {
              "type": "object",
              "widget": {
                "name": "container"
              },
              "properties": {
                "header": {
                  "type": "string",
                  "widget": {
                    "name": "container",
                    "options": {
                      "label": "Выбор дополнительных услуг"
                    },
                    "kind": "container-popup-with-h1-no-form-collapsed-style"
                  }
                },
                "search": {
                  "type": "object",
                  "model": "#searchServices",
                  "widget": {
                    "name": "container",
                    "options": {
                      "displayNone": false,
                      "routerOptions": [
                        "displayNone"
                      ]
                    },
                    "kind": "container-search-form-collapsed-container-style"
                  },
                  "properties": {
                    "typeOrName": {
                      "type": "string",
                      "validation": [
                        {
                          "type": "schema",
                          "params": {
                            "rule": "$ref:rule-validation:snippets/validation/checks/length-255"
                          },
                          "events": [
                            "onBackend",
                            "onUpdate"
                          ]
                        }
                      ],
                      "widget": {
                        "name": "input-group-button",
                        "options": {
                          "placeholder": "Наименование, тип услуги",
                          "actionButtonLabel": "Найти",
                          "actionButtonIconMobile": "icon-search",
                          "enableClearButton": true
                        },
                        "events": {
                          "actionButtonClick": "$ref:operation-frontend:room/edit/search-apply-services",
                          "keypress-13": "$ref:operation-frontend:room/edit/search-apply-services"
                        }
                      }
                    }
                  }
                },
                "selected-count": {
                  "type": "string",
                  "model": false,
                  "widget": {
                    "name": "html",
                    "class": {
                      "value": "mrg-b-xs"
                    }
                  },
                  "value": {
                    "$replace": {
                      "template": "<p>Выбрано услуг: {{0}}</p>",
                      "data": [
                        {
                          "$if": {
                            "condition": {
                              "$not-empty": {
                                "data": {
                                  "$element-option": {
                                    "option": "selection$",
                                    "path": "#selectorServices"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$length": {
                                "data": {
                                  "$element-option": {
                                    "option": "selection$",
                                    "path": "#selectorServices"
                                  }
                                }
                              }
                            },
                            "else": 0
                          }
                        }
                      ]
                    }
                  }
                },
                "selected-chips": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "widget": "info"
                  },
                  "model": "#selected-chips",
                  "widget": {
                    "name": "chips",
                    "class": {
                      "value": "chips-invite-suppliers mrg-b-sm"
                    },
                    "options": {
                      "onlyRemove": true,
                      "allowDuplicate": false,
                      "disabled": true
                    },
                    "events": {
                      "onRemove": {
                        "$http-code": {
                          "200": {
                            "$element-option": {
                              "path": "#selectorServices",
                              "option": "selection",
                              "value": {
                                "$array-filter": {
                                  "array": {
                                    "$element-option": {
                                      "path": "#selectorServices",
                                      "option": "selection"
                                    }
                                  },
                                  "filter": {
                                    "!==": {
                                      "operand1": {
                                        "$from-context": {
                                          "path": "$data"
                                        }
                                      },
                                      "operand2": {
                                        "$from-context": {
                                          "path": "$response.body.data.pagination.items.0.serviceId"
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "client": {
                            "$api-data": {
                              "id": "$ref:operation-frontend:snippets/element/_api/api-data-optional-id",
                              "options": {
                                "observe": "response"
                              },
                              "query": "additional_service/get_for_select",
                              "variables": {
                                "name": {
                                  "$from-context": {
                                    "path": "$event.event"
                                  }
                                },
                                "first": 0,
                                "rows": 10
                              }
                            }
                          },
                          "default": {
                            "$message": {
                              "severity": "error",
                              "summary": "Ошибка",
                              "detail": "Не удалось получить данные c сервера, попробуйте позднее"
                            }
                          }
                        }
                      }
                    }
                  },
                  "value": {
                    "$if": {
                      "condition": {
                        "$not-empty": {
                          "data": {
                            "$subs": {
                              "path": "#data.room.additional_services"
                            }
                          }
                        }
                      },
                      "then": {
                        "$array-pluck": {
                          "array": {
                            "$var": {
                              "path": "#data.room.additional_services"
                            }
                          },
                          "key": "name"
                        }
                      },
                      "else": []
                    }
                  }
                },
                "table": {
                  "value": {
                    "$api-table-workflow-data": {
                      "model": "#selectorServices",
                      "query": "additional_service/get_for_select",
                      "variables": {
                        "$graphql-event-variables": {
                          "data": {
                            "$element-event": {
                              "event": "lazyLoad"
                            }
                          }
                        }
                      },
                      "id": {
                        "$query-params": {
                          "name": "id"
                        }
                      },
                      "errors": {
                        "default": {
                          "$message": {
                            "severity": "error",
                            "summary": "Ошибка",
                            "detail": "При загрузке данных произошла ошибка, повторите попытку позднее"
                          }
                        }
                      }
                    }
                  },
                  "type": "array",
                  "model": "#selectorServices",
                  "widget": {
                    "name": "table-lazy",
                    "options": {
                      "selectionMode": "multiple",
                      "selectionField": "selected",
                      "selectionKey": "serviceId",
                      "first": 0,
                      "lazy": true,
                      "paginator": true,
                      "rows": 10,
                      "rowsPerPageOptions": [
                        10,
                        20,
                        50
                      ],
                      "routerOptions": [
                        "first",
                        "rows"
                      ],
                      "initialFilters": {
                        "$var": {
                          "path": "#selectorServices"
                        }
                      },
                      "sortField": "name",
                      "sortOrder": 1
                    },
                    "class": {
                      "value": "data-table d-block mrg-b-lg"
                    },
                    "events": {
                      "lazyLoad": {
                        "$element-option": {
                          "path": "#selectorServices",
                          "option": "loading",
                          "value": true
                        }
                      },
                      "onRowSelect": {
                        "$populate": {
                          "path": "#selected-chips",
                          "data": {
                            "$array-push": {
                              "array": {
                                "$var": {
                                  "path": "#selected-chips"
                                }
                              },
                              "data": {
                                "$from-context": {
                                  "path": "$event.event.value.name"
                                }
                              }
                            }
                          }
                        }
                      },
                      "onRowUnselect": {
                        "$populate": {
                          "path": "#selected-chips",
                          "data": {
                            "$array-filter": {
                              "array": {
                                "$var": {
                                  "path": "#selected-chips"
                                }
                              },
                              "filter": {
                                "!==": {
                                  "operand1": {
                                    "$from-context": {
                                      "path": "$data"
                                    }
                                  },
                                  "operand2": {
                                    "$from-context": {
                                      "path": "$event.event.value.name"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      },
                      "onHeaderCheckboxToggle": {
                        "$if": {
                          "condition": {
                            "===": {
                              "operand1": {
                                "$from-context": {
                                  "path": "$event.event"
                                }
                              },
                              "operand2": true
                            }
                          },
                          "then": {
                            "$populate": {
                              "path": "#selected-chips",
                              "data": {
                                "$apply-func": {
                                  "func": "return [...new Set([...chipsArr, ...currPageServices])]",
                                  "args": {
                                    "chipsArr": {
                                      "$var": {
                                        "path": "#selected-chips"
                                      }
                                    },
                                    "currPageServices": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#selectorServices"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "else": {
                            "$populate": {
                              "path": "#selected-chips",
                              "data": {
                                "$apply-func": {
                                  "func": "return chipsArr.filter( function( el ) { return currPageServices.indexOf( el ) < 0; } )",
                                  "args": {
                                    "chipsArr": {
                                      "$var": {
                                        "path": "#selected-chips"
                                      }
                                    },
                                    "currPageServices": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#selectorServices"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "subscriptions": {
                      "reload-table": {
                        "$element-event": {
                          "event": "reload",
                          "value": true
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "object",
                    "properties": {
                      "serviceId": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "selected": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "name": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Наименование"
                          }
                        }
                      },
                      "servicesType": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Тип услуги"
                          }
                        },
                        "properties": {
                          "name": {
                            "type": "string",
                            "widget": {
                              "name": "info"
                            }
                          }
                        }
                      },
                      "unitPrice": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "unitPriceView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Цена (руб.)"
                          }
                        },
                        "properties": {
                          "price": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "formatter": "number:'0.2-2':'ru'",
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.unitPrice"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "actions": {
                  "type": "object",
                  "widget": {
                    "name": "container",
                    "class": {
                      "group": "form-actions p-field p-grid mrg-t-lg",
                      "value": "p-jc-xs-end p-autolayout"
                    }
                  },
                  "properties": {
                    "save": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "label": "Добавить выбранные"
                        },
                        "events": {
                          "click": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#data.room.additional_services",
                                    "data": {
                                      "$if": {
                                        "condition": {
                                          ">": {
                                            "operand1": {
                                              "$length": {
                                                "data": {
                                                  "$element-option": {
                                                    "path": "#selectorServices",
                                                    "option": "selection"
                                                  }
                                                }
                                              }
                                            },
                                            "operand2": 0
                                          }
                                        },
                                        "then": {
                                          "$fetch-object": {
                                            "path": "data.pagination.items",
                                            "data": {
                                              "$api-data": {
                                                "id": {
                                                  "$if": {
                                                    "condition": {
                                                      "$not-empty": {
                                                        "data": {
                                                          "$query-params": {
                                                            "name": "id",
                                                            "filter": false
                                                          }
                                                        }
                                                      }
                                                    },
                                                    "then": {
                                                      "$query-params": {
                                                        "name": "id",
                                                        "filter": false
                                                      }
                                                    },
                                                    "else": ""
                                                  }
                                                },
                                                "query": "additional_service/get_for_select",
                                                "variables": {
                                                  "ids": {
                                                    "$element-option": {
                                                      "path": "#selectorServices",
                                                      "option": "selection"
                                                    }
                                                  },
                                                  "first": 0,
                                                  "rows": {
                                                    "$length": {
                                                      "data": {
                                                        "$element-option": {
                                                          "path": "#selectorServices",
                                                          "option": "selection"
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        },
                                        "else": []
                                      }
                                    }
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectServices",
                                    "value": false
                                  }
                                }
                              ]
                            }
                          }
                        }
                      }
                    },
                    "cancel": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "label": "Отмена"
                        },
                        "events": {
                          "click": "$ref:operation-frontend:room/edit/close-modal-services"
                        },
                        "kind": "button-search-form-clear-button-right-style"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "selectEquipments": {
          "type": "object",
          "model": "#modalSelectEquipments",
          "widget": {
            "name": "dialog",
            "options": {
              "visible": false,
              "closable": true
            }
          },
          "properties": {
            "content": {
              "type": "object",
              "widget": {
                "name": "container"
              },
              "properties": {
                "header": {
                  "type": "string",
                  "widget": {
                    "name": "container",
                    "options": {
                      "label": "Выбор оборудования"
                    },
                    "kind": "container-popup-with-h1-no-form-collapsed-style"
                  }
                },
                "search": {
                  "type": "object",
                  "model": "#searchEquipments",
                  "widget": {
                    "name": "container",
                    "options": {
                      "displayNone": false,
                      "routerOptions": [
                        "displayNone"
                      ]
                    },
                    "kind": "container-search-form-collapsed-container-style"
                  },
                  "properties": {
                    "typeOrNumber": {
                      "type": "string",
                      "validation": [
                        {
                          "type": "schema",
                          "params": {
                            "rule": "$ref:rule-validation:snippets/validation/checks/length-255"
                          },
                          "events": [
                            "onBackend",
                            "onUpdate"
                          ]
                        }
                      ],
                      "widget": {
                        "name": "input-group-button",
                        "options": {
                          "placeholder": "Наименование, номенклатурный номер оборудования",
                          "actionButtonLabel": "Найти",
                          "actionButtonIconMobile": "icon-search",
                          "enableClearButton": true
                        },
                        "events": {
                          "actionButtonClick": "$ref:operation-frontend:room/edit/search-apply-equipments",
                          "keypress-13": "$ref:operation-frontend:room/edit/search-apply-equipments"
                        }
                      }
                    }
                  }
                },
                "selected-count": {
                  "type": "string",
                  "model": false,
                  "widget": {
                    "name": "html",
                    "class": {
                      "value": "mrg-b-xs"
                    }
                  },
                  "value": {
                    "$replace": {
                      "template": "<p>Выбрано оборудования: {{0}}</p>",
                      "data": [
                        {
                          "$if": {
                            "condition": {
                              "$not-empty": {
                                "data": {
                                  "$element-option": {
                                    "option": "selection$",
                                    "path": "#selectorEquipments"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$length": {
                                "data": {
                                  "$element-option": {
                                    "option": "selection$",
                                    "path": "#selectorEquipments"
                                  }
                                }
                              }
                            },
                            "else": 0
                          }
                        }
                      ]
                    }
                  }
                },
                "selected-chips-equipment": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "widget": "info"
                  },
                  "model": "#selected-chips-equipment",
                  "widget": {
                    "name": "chips",
                    "class": {
                      "value": "chips-invite-suppliers mrg-b-sm"
                    },
                    "options": {
                      "onlyRemove": true,
                      "allowDuplicate": false,
                      "disabled": true
                    },
                    "events": {
                      "onRemove": {
                        "$http-code": {
                          "200": {
                            "$element-option": {
                              "path": "#selectorEquipments",
                              "option": "selection",
                              "value": {
                                "$array-filter": {
                                  "array": {
                                    "$element-option": {
                                      "path": "#selectorEquipments",
                                      "option": "selection"
                                    }
                                  },
                                  "filter": {
                                    "!==": {
                                      "operand1": {
                                        "$from-context": {
                                          "path": "$data"
                                        }
                                      },
                                      "operand2": {
                                        "$from-context": {
                                          "path": "$response.body.data.pagination.items.0.equipmentId"
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "client": {
                            "$api-data": {
                              "id": "$ref:operation-frontend:snippets/element/_api/api-data-optional-id",
                              "options": {
                                "observe": "response"
                              },
                              "query": "equipment/get_for_select",
                              "variables": {
                                "name": {
                                  "$from-context": {
                                    "path": "$event.event"
                                  }
                                },
                                "first": 0,
                                "rows": 10
                              }
                            }
                          },
                          "default": {
                            "$message": {
                              "severity": "error",
                              "summary": "Ошибка",
                              "detail": "Не удалось получить данные c сервера, попробуйте позднее"
                            }
                          }
                        }
                      }
                    }
                  },
                  "value": {
                    "$if": {
                      "condition": {
                        "$not-empty": {
                          "data": {
                            "$subs": {
                              "path": "#data.room.equipments"
                            }
                          }
                        }
                      },
                      "then": {
                        "$array-pluck": {
                          "array": {
                            "$var": {
                              "path": "#data.room.equipments"
                            }
                          },
                          "key": "name"
                        }
                      },
                      "else": []
                    }
                  }
                },
                "table": {
                  "value": {
                    "$api-table-workflow-data": {
                      "model": "#selectorEquipments",
                      "query": "equipment/get_for_select",
                      "variables": {
                        "$graphql-event-variables": {
                          "data": {
                            "$element-event": {
                              "event": "lazyLoad"
                            }
                          }
                        }
                      },
                      "id": {
                        "$query-params": {
                          "name": "id"
                        }
                      },
                      "errors": {
                        "default": {
                          "$message": {
                            "severity": "error",
                            "summary": "Ошибка",
                            "detail": "При загрузке данных произошла ошибка, повторите попытку позднее"
                          }
                        }
                      }
                    }
                  },
                  "type": "array",
                  "model": "#selectorEquipments",
                  "widget": {
                    "name": "table-lazy",
                    "options": {
                      "selectionMode": "multiple",
                      "selectionField": "selected",
                      "selectionKey": "equipmentId",
                      "first": 0,
                      "lazy": true,
                      "paginator": true,
                      "rows": 10,
                      "rowsPerPageOptions": [
                        10,
                        20,
                        50
                      ],
                      "routerOptions": [
                        "first",
                        "rows"
                      ],
                      "initialFilters": {
                        "$var": {
                          "path": "#selectorEquipments"
                        }
                      },
                      "sortField": "name",
                      "sortOrder": 1
                    },
                    "class": {
                      "value": "data-table d-block mrg-b-lg"
                    },
                    "events": {
                      "lazyLoad": {
                        "$element-option": {
                          "path": "#selectorEquipments",
                          "option": "loading",
                          "value": true
                        }
                      },
                      "onRowSelect": {
                        "$populate": {
                          "path": "#selected-chips-equipment",
                          "data": {
                            "$array-push": {
                              "array": {
                                "$var": {
                                  "path": "#selected-chips-equipment"
                                }
                              },
                              "data": {
                                "$from-context": {
                                  "path": "$event.event.value.name"
                                }
                              }
                            }
                          }
                        }
                      },
                      "onRowUnselect": {
                        "$populate": {
                          "path": "#selected-chips-equipment",
                          "data": {
                            "$array-filter": {
                              "array": {
                                "$var": {
                                  "path": "#selected-chips-equipment"
                                }
                              },
                              "filter": {
                                "!==": {
                                  "operand1": {
                                    "$from-context": {
                                      "path": "$data"
                                    }
                                  },
                                  "operand2": {
                                    "$from-context": {
                                      "path": "$event.event.value.name"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      },
                      "onHeaderCheckboxToggle": {
                        "$if": {
                          "condition": {
                            "===": {
                              "operand1": {
                                "$from-context": {
                                  "path": "$event.event"
                                }
                              },
                              "operand2": true
                            }
                          },
                          "then": {
                            "$populate": {
                              "path": "#selected-chips-equipment",
                              "data": {
                                "$apply-func": {
                                  "func": "return [...new Set([...chipsArr, ...currPageServices])]",
                                  "args": {
                                    "chipsArr": {
                                      "$var": {
                                        "path": "#selected-chips-equipment"
                                      }
                                    },
                                    "currPageServices": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#selectorEquipments"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "else": {
                            "$populate": {
                              "path": "#selected-chips-equipment",
                              "data": {
                                "$apply-func": {
                                  "func": "return chipsArr.filter( function( el ) { return currPageServices.indexOf( el ) < 0; } )",
                                  "args": {
                                    "chipsArr": {
                                      "$var": {
                                        "path": "#selected-chips-equipment"
                                      }
                                    },
                                    "currPageServices": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#selectorEquipments"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "subscriptions": {
                      "reload-table": {
                        "$element-event": {
                          "event": "reload",
                          "value": true
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "object",
                    "properties": {
                      "equipmentId": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "selected": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "name": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Наименование оборудования"
                          }
                        }
                      },
                      "nomenclatureNumber": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Номенклатурный номер"
                          }
                        }
                      },
                      "unitPrice": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "unitPriceView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Цена (руб.)"
                          }
                        },
                        "properties": {
                          "price": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "formatter": "number:'0.2-2':'ru'",
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.unitPrice"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "actions": {
                  "type": "object",
                  "widget": {
                    "name": "container",
                    "class": {
                      "group": "form-actions p-field p-grid mrg-t-lg",
                      "value": "p-jc-xs-end p-autolayout"
                    }
                  },
                  "properties": {
                    "save": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "label": "Добавить выбранные"
                        },
                        "events": {
                          "click": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#data.room.equipments",
                                    "data": {
                                      "$if": {
                                        "condition": {
                                          ">": {
                                            "operand1": {
                                              "$length": {
                                                "data": {
                                                  "$element-option": {
                                                    "path": "#selectorEquipments",
                                                    "option": "selection"
                                                  }
                                                }
                                              }
                                            },
                                            "operand2": 0
                                          }
                                        },
                                        "then": {
                                          "$fetch-object": {
                                            "path": "data.pagination.items",
                                            "data": {
                                              "$api-data": {
                                                "id": {
                                                  "$if": {
                                                    "condition": {
                                                      "$not-empty": {
                                                        "data": {
                                                          "$query-params": {
                                                            "name": "id",
                                                            "filter": false
                                                          }
                                                        }
                                                      }
                                                    },
                                                    "then": {
                                                      "$query-params": {
                                                        "name": "id",
                                                        "filter": false
                                                      }
                                                    },
                                                    "else": ""
                                                  }
                                                },
                                                "query": "equipment/get_for_select",
                                                "variables": {
                                                  "ids": {
                                                    "$element-option": {
                                                      "path": "#selectorEquipments",
                                                      "option": "selection"
                                                    }
                                                  },
                                                  "first": 0,
                                                  "rows": {
                                                    "$length": {
                                                      "data": {
                                                        "$element-option": {
                                                          "path": "#selectorEquipments",
                                                          "option": "selection"
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        },
                                        "else": []
                                      }
                                    }
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectEquipments",
                                    "value": false
                                  }
                                }
                              ]
                            }
                          }
                        }
                      }
                    },
                    "cancel": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "label": "Отмена"
                        },
                        "events": {
                          "click": "$ref:operation-frontend:room/edit/close-modal-equipments"
                        },
                        "kind": "button-search-form-clear-button-right-style"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "selectFurniture": {
          "type": "object",
          "model": "#modalSelectFurniture",
          "widget": {
            "name": "dialog",
            "options": {
              "visible": false,
              "closable": true
            }
          },
          "properties": {
            "content": {
              "type": "object",
              "widget": {
                "name": "container"
              },
              "properties": {
                "header": {
                  "type": "string",
                  "widget": {
                    "name": "container",
                    "options": {
                      "label": "Выбор мебели"
                    },
                    "kind": "container-popup-with-h1-no-form-collapsed-style"
                  }
                },
                "search": {
                  "type": "object",
                  "model": "#searchFurniture",
                  "widget": {
                    "name": "container",
                    "options": {
                      "displayNone": false,
                      "routerOptions": [
                        "displayNone"
                      ]
                    },
                    "kind": "container-search-form-collapsed-container-style"
                  },
                  "properties": {
                    "typeOrNumber": {
                      "type": "string",
                      "validation": [
                        {
                          "type": "schema",
                          "params": {
                            "rule": "$ref:rule-validation:snippets/validation/checks/length-255"
                          },
                          "events": [
                            "onBackend",
                            "onUpdate"
                          ]
                        }
                      ],
                      "widget": {
                        "name": "input-group-button",
                        "options": {
                          "placeholder": "Наименование, номенклатурный номер мебели",
                          "actionButtonLabel": "Найти",
                          "actionButtonIconMobile": "icon-search",
                          "enableClearButton": true
                        },
                        "events": {
                          "actionButtonClick": "$ref:operation-frontend:room/edit/search-apply-furniture",
                          "keypress-13": "$ref:operation-frontend:room/edit/search-apply-furniture"
                        }
                      }
                    }
                  }
                },
                "selected-count": {
                  "type": "string",
                  "model": false,
                  "widget": {
                    "name": "html",
                    "class": {
                      "value": "mrg-b-xs"
                    }
                  },
                  "value": {
                    "$replace": {
                      "template": "<p>Выбрано мебели: {{0}}</p>",
                      "data": [
                        {
                          "$if": {
                            "condition": {
                              "$not-empty": {
                                "data": {
                                  "$element-option": {
                                    "option": "selection$",
                                    "path": "#selectorFurniture"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$length": {
                                "data": {
                                  "$element-option": {
                                    "option": "selection$",
                                    "path": "#selectorFurniture"
                                  }
                                }
                              }
                            },
                            "else": 0
                          }
                        }
                      ]
                    }
                  }
                },
                "selected-chips-furniture": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "widget": "info"
                  },
                  "model": "#selected-chips-furniture",
                  "widget": {
                    "name": "chips",
                    "class": {
                      "value": "chips-invite-suppliers mrg-b-sm"
                    },
                    "options": {
                      "onlyRemove": true,
                      "allowDuplicate": false,
                      "disabled": true
                    },
                    "events": {
                      "onRemove": {
                        "$http-code": {
                          "200": {
                            "$element-option": {
                              "path": "#selectorFurniture",
                              "option": "selection",
                              "value": {
                                "$array-filter": {
                                  "array": {
                                    "$element-option": {
                                      "path": "#selectorFurniture",
                                      "option": "selection"
                                    }
                                  },
                                  "filter": {
                                    "!==": {
                                      "operand1": {
                                        "$from-context": {
                                          "path": "$data"
                                        }
                                      },
                                      "operand2": {
                                        "$from-context": {
                                          "path": "$response.body.data.pagination.items.0.furnitureId"
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "client": {
                            "$api-data": {
                              "id": "$ref:operation-frontend:snippets/element/_api/api-data-optional-id",
                              "options": {
                                "observe": "response"
                              },
                              "query": "furniture/get_for_select",
                              "variables": {
                                "name": {
                                  "$from-context": {
                                    "path": "$event.event"
                                  }
                                },
                                "first": 0,
                                "rows": 10
                              }
                            }
                          },
                          "default": {
                            "$message": {
                              "severity": "error",
                              "summary": "Ошибка",
                              "detail": "Не удалось получить данные c сервера, попробуйте позднее"
                            }
                          }
                        }
                      }
                    }
                  },
                  "value": {
                    "$if": {
                      "condition": {
                        "$not-empty": {
                          "data": {
                            "$subs": {
                              "path": "#data.room.furniture"
                            }
                          }
                        }
                      },
                      "then": {
                        "$array-pluck": {
                          "array": {
                            "$var": {
                              "path": "#data.room.furniture"
                            }
                          },
                          "key": "name"
                        }
                      },
                      "else": []
                    }
                  }
                },
                "table": {
                  "value": {
                    "$api-table-workflow-data": {
                      "model": "#selectorFurniture",
                      "query": "furniture/get_for_select",
                      "id": {
                        "$query-params": {
                          "name": "id"
                        }
                      },
                      "variables": {
                        "$graphql-event-variables": {
                          "data": {
                            "$element-event": {
                              "event": "lazyLoad"
                            }
                          }
                        }
                      },
                      "errors": {
                        "default": {
                          "$message": {
                            "severity": "error",
                            "summary": "Ошибка",
                            "detail": "При загрузке данных произошла ошибка, повторите попытку позднее"
                          }
                        }
                      }
                    }
                  },
                  "type": "array",
                  "model": "#selectorFurniture",
                  "widget": {
                    "name": "table-lazy",
                    "options": {
                      "selectionMode": "multiple",
                      "selectionField": "selected",
                      "selectionKey": "furnitureId",
                      "first": 0,
                      "lazy": true,
                      "paginator": true,
                      "rows": 10,
                      "rowsPerPageOptions": [
                        10,
                        20,
                        50
                      ],
                      "routerOptions": [
                        "first",
                        "rows"
                      ],
                      "initialFilters": {
                        "$var": {
                          "path": "#selectorFurniture"
                        }
                      },
                      "sortField": "name",
                      "sortOrder": 1
                    },
                    "class": {
                      "value": "data-table d-block mrg-b-lg"
                    },
                    "events": {
                      "lazyLoad": {
                        "$element-option": {
                          "path": "#selectorFurniture",
                          "option": "loading",
                          "value": true
                        }
                      },
                      "onRowSelect": {
                        "$populate": {
                          "path": "#selected-chips-furniture",
                          "data": {
                            "$array-push": {
                              "array": {
                                "$var": {
                                  "path": "#selected-chips-furniture"
                                }
                              },
                              "data": {
                                "$from-context": {
                                  "path": "$event.event.value.name"
                                }
                              }
                            }
                          }
                        }
                      },
                      "onRowUnselect": {
                        "$populate": {
                          "path": "#selected-chips-furniture",
                          "data": {
                            "$array-filter": {
                              "array": {
                                "$var": {
                                  "path": "#selected-chips-furniture"
                                }
                              },
                              "filter": {
                                "!==": {
                                  "operand1": {
                                    "$from-context": {
                                      "path": "$data"
                                    }
                                  },
                                  "operand2": {
                                    "$from-context": {
                                      "path": "$event.event.value.name"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      },
                      "onHeaderCheckboxToggle": {
                        "$if": {
                          "condition": {
                            "===": {
                              "operand1": {
                                "$from-context": {
                                  "path": "$event.event"
                                }
                              },
                              "operand2": true
                            }
                          },
                          "then": {
                            "$populate": {
                              "path": "#selected-chips-furniture",
                              "data": {
                                "$apply-func": {
                                  "func": "return [...new Set([...chipsArr, ...currPageServices])]",
                                  "args": {
                                    "chipsArr": {
                                      "$var": {
                                        "path": "#selected-chips-furniture"
                                      }
                                    },
                                    "currPageServices": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#selectorFurniture"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "else": {
                            "$populate": {
                              "path": "#selected-chips-furniture",
                              "data": {
                                "$apply-func": {
                                  "func": "return chipsArr.filter( function( el ) { return currPageServices.indexOf( el ) < 0; } )",
                                  "args": {
                                    "chipsArr": {
                                      "$var": {
                                        "path": "#selected-chips-furniture"
                                      }
                                    },
                                    "currPageServices": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#selectorFurniture"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "subscriptions": {
                      "reload-table": {
                        "$element-event": {
                          "event": "reload",
                          "value": true
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "object",
                    "properties": {
                      "furnitureId": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "selected": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "name": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Наименование мебели"
                          }
                        }
                      },
                      "nomenclatureNumber": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Номенклатурный номер"
                          }
                        }
                      },
                      "unitPrice": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "unitPriceView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Цена (руб.)"
                          }
                        },
                        "properties": {
                          "price": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "formatter": "number:'0.2-2':'ru'",
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.unitPrice"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "actions": {
                  "type": "object",
                  "widget": {
                    "name": "container",
                    "class": {
                      "group": "form-actions p-field p-grid mrg-t-lg",
                      "value": "p-jc-xs-end p-autolayout"
                    }
                  },
                  "properties": {
                    "save": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "label": "Добавить выбранные"
                        },
                        "events": {
                          "click": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#data.room.furniture",
                                    "data": {
                                      "$if": {
                                        "condition": {
                                          ">": {
                                            "operand1": {
                                              "$length": {
                                                "data": {
                                                  "$element-option": {
                                                    "path": "#selectorFurniture",
                                                    "option": "selection"
                                                  }
                                                }
                                              }
                                            },
                                            "operand2": 0
                                          }
                                        },
                                        "then": {
                                          "$fetch-object": {
                                            "path": "data.pagination.items",
                                            "data": {
                                              "$api-data": {
                                                "id": {
                                                  "$if": {
                                                    "condition": {
                                                      "$not-empty": {
                                                        "data": {
                                                          "$query-params": {
                                                            "name": "id",
                                                            "filter": false
                                                          }
                                                        }
                                                      }
                                                    },
                                                    "then": {
                                                      "$query-params": {
                                                        "name": "id",
                                                        "filter": false
                                                      }
                                                    },
                                                    "else": ""
                                                  }
                                                },
                                                "query": "furniture/get_for_select",
                                                "variables": {
                                                  "ids": {
                                                    "$element-option": {
                                                      "path": "#selectorFurniture",
                                                      "option": "selection"
                                                    }
                                                  },
                                                  "first": 0,
                                                  "rows": {
                                                    "$length": {
                                                      "data": {
                                                        "$element-option": {
                                                          "path": "#selectorFurniture",
                                                          "option": "selection"
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        },
                                        "else": []
                                      }
                                    }
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectFurniture",
                                    "value": false
                                  }
                                }
                              ]
                            }
                          }
                        }
                      }
                    },
                    "cancel": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "label": "Отмена"
                        },
                        "events": {
                          "click": "$ref:operation-frontend:room/edit/close-modal-furniture"
                        },
                        "kind": "button-search-form-clear-button-right-style"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "booking": {
          "type": "object",
          "model": "#modalBooking",
          "widget": {
            "name": "dialog",
            "options": {
              "visible": false,
              "closable": true
            }
          },
          "properties": {
            "content": {
              "type": "object",
              "widget": {
                "name": "container"
              },
              "properties": {
                "header": {
                  "type": "string",
                  "widget": {
                    "name": "container",
                    "options": {
                      "label": "Предупреждение о запланированных мероприятиях"
                    },
                    "kind": "container-popup-with-h1-no-form-collapsed-style"
                  }
                },
                "beforeTable": {
                  "type": "string",
                  "widget": {
                    "name": "info",
                    "options": {
                      "viewedValue": {
                        "$replace": {
                          "template": "В помещении \"{{room}}\" запланированы следующие мероприятия:",
                          "data": {
                            "room": {
                              "$from-context": {
                                "path": "@preload.room.name"
                              }
                            }
                          }
                        }
                      }
                    },
                    "class": {
                      "value": "mrg-b-md"
                    }
                  }
                },
                "table": {
                  "value": {
                    "$from-context": {
                      "path": "@preload.booking"
                    }
                  },
                  "type": "array",
                  "model": "#booking",
                  "widget": {
                    "name": "table",
                    "options": {
                      "first": 0,
                      "paginator": true,
                      "rows": 5,
                      "rowsPerPageOptions": [
                        5,
                        10,
                        20
                      ],
                      "routerOptions": [
                        "first",
                        "rows"
                      ],
                      "sortField": "name",
                      "sortOrder": 1
                    },
                    "class": {
                      "value": "data-table d-block mrg-b-s"
                    },
                    "events": {},
                    "subscriptions": {}
                  },
                  "items": {
                    "type": "object",
                    "properties": {
                      "number": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "№",
                            "viewedValue": {
                              "$collection": {
                                "action": "row-number"
                              }
                            }
                          },
                          "class": {
                            "header": "column_actions",
                            "cell": "column_actions"
                          }
                        }
                      },
                      "eventId": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "event": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        },
                        "properties": {
                          "name": {
                            "type": "string",
                            "widget": {
                              "name": "hidden"
                            }
                          },
                          "state": {
                            "type": "string",
                            "widget": {
                              "name": "hidden"
                            }
                          }
                        }
                      },
                      "minDate": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "maxDate": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "eventView": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Мероприятие",
                            "visible": true
                          }
                        },
                        "properties": {
                          "name": {
                            "type": "string",
                            "widget": {
                              "name": "info",
                              "options": {
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.event.name"
                                  }
                                }
                              }
                            }
                          }
                        }
                      },
                      "bookingView": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Даты брони помещения",
                            "visible": true
                          },
                          "class": {
                            "header": "column_actions",
                            "cell": "column_actions"
                          }
                        },
                        "value": {
                          "$replace": {
                            "template": "{{start}} - {{end}}",
                            "data": {
                              "start": {
                                "$formatter": {
                                  "format": "$ref:operation-frontend:snippets/element/_active_user_timezone/datetime-formatter",
                                  "data": {
                                    "$from-context": {
                                      "path": "$rowData.minDate"
                                    }
                                  }
                                }
                              },
                              "end": {
                                "$formatter": {
                                  "format": "$ref:operation-frontend:snippets/element/_active_user_timezone/datetime-formatter",
                                  "data": {
                                    "$from-context": {
                                      "path": "$rowData.maxDate"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      },
                      "status": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Статус мероприятия"
                          }
                        },
                        "properties": {
                          "stateView": {
                            "type": "string",
                            "value": {
                              "$from-context": {
                                "path": "$rowData.event.state"
                              }
                            },
                            "widget": {
                              "name": "badge",
                              "options": {
                                "defaultLabel": "",
                                "displayMapping": [
                                  {
                                    "color": "badge_default",
                                    "label": "Предварительная бронь",
                                    "value": "pre_booking"
                                  },
                                  {
                                    "color": "badge_warning",
                                    "label": "Получен запрос",
                                    "value": "requested"
                                  },
                                  {
                                    "color": "badge_custom_orange",
                                    "label": "Получено ТЗ",
                                    "value": "task_received"
                                  },
                                  {
                                    "color": "badge_active",
                                    "label": "Согласована смета",
                                    "value": "agreed"
                                  },
                                  {
                                    "color": "badge_accent",
                                    "label": "Пройден check-in",
                                    "value": "check_in"
                                  },
                                  {
                                    "color": "badge_canceled",
                                    "label": "Пройден check-out",
                                    "value": "check_out"
                                  }
                                ]
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "afterTable": {
                  "type": "string",
                  "widget": {
                    "name": "info"
                  },
                  "value": "Вы уверены, что хотите сохранить изменения по данному помещению?"
                },
                "actions": {
                  "type": "object",
                  "widget": {
                    "name": "container",
                    "class": {
                      "group": "form-actions p-field p-grid mrg-t-lg",
                      "value": "p-jc-xs-end p-autolayout"
                    }
                  },
                  "properties": {
                    "accept": {
                      "widget": {
                        "name": "submit-button",
                        "options": {
                          "label": "Подтвердить",
                          "clientValidation": true,
                          "dataForClientValidation": "/",
                          "showClientValidationErrorsForElement": "form",
                          "showClientValidationErrorMessage": true,
                          "clientValidationErrorMessageSummary": "Ошибка",
                          "clientValidationErrorMessageDetail": "Одно или несколько полей заполнены некорректно",
                          "workflowAction": "room.edit",
                          "workflowObjectId": {
                            "$query-params": {
                              "name": "id"
                            }
                          },
                          "dataForSubmit": {
                            "$exclude": {
                              "data": {
                                "$var": {
                                  "path": "#data.room"
                                }
                              },
                              "exclude": [
                                "room_type"
                              ]
                            }
                          },
                          "showSuccessMessage": true,
                          "successMessageSummary": "Редактирование помещения",
                          "successMessageDetail": "Данные помещения успешно изменены",
                          "urlInCaseOfSuccess": "/cabinet/room/list",
                          "showServerValidationErrorMessage": true,
                          "serverValidationErrorMessageSummary": "Редактирование помещения",
                          "serverValidationErrorMessageDetail": "Форма содержит ошибки",
                          "showOtherErrorMessageSummary": true,
                          "otherErrorMessageSummary": "Редактирование помещения",
                          "otherErrorMessageDetail": "Непредвиденная ошибка",
                          "reloadTable": true,
                          "closePopup": false
                        },
                        "class": {
                          "value": "mrg-r-sm"
                        }
                      }
                    },
                    "cancel": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "label": "Отмена"
                        },
                        "events": {
                          "click": {
                            "$element-option": {
                              "option": "visible",
                              "path": "#modalBooking",
                              "value": false
                            }
                          }
                        },
                        "kind": "button-search-form-clear-button-right-style"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "form": {
      "type": "object",
      "model": "#data.room",
      "value": "$ref:operation-frontend:snippets/element/preload_delayed_value@@@preload.room",
      "widget": {
        "name": "form",
        "options": {
          "label": "Редактирование помещения"
        },
        "class": {
          "label": "h1 mrg-b-lg d-block",
          "value": "mrg-b-0 d-block"
        }
      },
      "properties": {
        "common": {
          "type": "object",
          "model": false,
          "widget": {
            "name": "container",
            "options": {
              "label": "Общие данные"
            },
            "kind": "container-form-group-with-h2-style"
          },
          "properties": {
            "name": {
              "type": "string",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Наименование"
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                },
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "<=": {
                        "operand1": {
                          "$length": {
                            "data": {
                              "$if": {
                                "condition": {
                                  "$not-empty": {
                                    "data": {
                                      "$var": {
                                        "path": "."
                                      }
                                    }
                                  }
                                },
                                "then": {
                                  "$var": {
                                    "path": "."
                                  }
                                },
                                "else": ""
                              }
                            }
                          }
                        },
                        "operand2": 255
                      }
                    },
                    "message": "Максимум 255 символов"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                }
              ]
            },
            "type": {
              "type": "string",
              "widget": {
                "name": "dropdown",
                "options": {
                  "label": "Тип помещения",
                  "optionLabel": "name",
                  "valueKey": "id",
                  "dataKey": "id",
                  "placeholder": "Выбрать",
                  "filter": true,
                  "valueOptions": {
                    "$fetch-object": {
                      "path": "data.items",
                      "data": {
                        "$api-data": {
                          "query": "room_type/get_for_dropdown"
                        }
                      }
                    }
                  }
                },
                "kind": "dropdown-dropdown-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onUpdate",
                    "onBackend"
                  ]
                }
              ]
            },
            "number": {
              "type": "string",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Номер"
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                },
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "<=": {
                        "operand1": {
                          "$length": {
                            "data": {
                              "$if": {
                                "condition": {
                                  "$not-empty": {
                                    "data": {
                                      "$var": {
                                        "path": "."
                                      }
                                    }
                                  }
                                },
                                "then": {
                                  "$var": {
                                    "path": "."
                                  }
                                },
                                "else": ""
                              }
                            }
                          }
                        },
                        "operand2": 255
                      }
                    },
                    "message": "Максимум 255 символов"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                }
              ]
            },
            "floor": {
              "type": "string",
              "value": "1",
              "widget": {
                "name": "radio-button",
                "options": {
                  "label": "Этаж",
                  "valueKey": "code",
                  "optionLabel": "title",
                  "valueOptions": [
                    {
                      "code": "open_area",
                      "title": "Открытая выставочная площадь"
                    },
                    {
                      "code": "1",
                      "title": "1 этаж"
                    },
                    {
                      "code": "1,5",
                      "title": "1,5 этаж"
                    },
                    {
                      "code": "2",
                      "title": "2 этаж"
                    }
                  ]
                },
                "kind": "radio-button-radio-vertical-list-required-style"
              }
            },
            "square": {
              "type": "number",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Площадь (м²)",
                  "inputmask": {
                    "alias": "integer",
                    "groupSeparator": " ",
                    "autoGroup": true,
                    "rightAlign": false,
                    "radixPoint": ",",
                    "allowMinus": false,
                    "digits": 2,
                    "integerDigits": 10
                  }
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                }
              ]
            },
            "roomLength": {
              "type": "number",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Длина (м)",
                  "inputmask": {
                    "alias": "integer",
                    "groupSeparator": " ",
                    "autoGroup": true,
                    "rightAlign": false,
                    "radixPoint": ",",
                    "allowMinus": false,
                    "digits": 2,
                    "integerDigits": 10
                  }
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                }
              ]
            },
            "width": {
              "type": "number",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Ширина (м)",
                  "inputmask": {
                    "alias": "integer",
                    "groupSeparator": " ",
                    "autoGroup": true,
                    "rightAlign": false,
                    "radixPoint": ",",
                    "allowMinus": false,
                    "digits": 2,
                    "integerDigits": 10
                  }
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                }
              ]
            },
            "height": {
              "type": "number",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Высота (м)",
                  "inputmask": {
                    "alias": "integer",
                    "groupSeparator": " ",
                    "autoGroup": true,
                    "rightAlign": false,
                    "radixPoint": ",",
                    "allowMinus": false,
                    "digits": 2,
                    "integerDigits": 10
                  }
                },
                "kind": "input-text-input-style"
              }
            },
            "roominess": {
              "type": "number",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Вместительность (чел.)",
                  "inputmask": {
                    "alias": "integer",
                    "groupSeparator": " ",
                    "autoGroup": true,
                    "rightAlign": false,
                    "allowMinus": false,
                    "digits": 0,
                    "integerDigits": 10
                  }
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                }
              ]
            },
            "maxOrganizers": {
              "type": "number",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Максимальное количество организаторов",
                  "inputmask": {
                    "alias": "integer",
                    "groupSeparator": " ",
                    "autoGroup": true,
                    "rightAlign": false,
                    "allowMinus": false,
                    "digits": 0,
                    "integerDigits": 10
                  }
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                }
              ]
            },
            "container_checkbox": {
              "type": "object",
              "model": false,
              "widget": {
                "name": "container",
                "options": {
                  "label": "Дополнительные параметры"
                },
                "kind": "container-text-input-style"
              },
              "properties": {
                "transformation": {
                  "type": "boolean",
                  "value": false,
                  "widget": {
                    "name": "checkbox",
                    "options": {
                      "optionLabel": "",
                      "optionLabelHTML": "Возможно частичное бронирование"
                    },
                    "class": {
                      "value": "form-item-element form-item-element_checkbox form-item-element_label-html"
                    }
                  }
                },
                "configuration": {
                  "type": "boolean",
                  "value": false,
                  "widget": {
                    "name": "checkbox",
                    "options": {
                      "optionLabel": "",
                      "optionLabelHTML": "Возможно включение в конфигурацию"
                    },
                    "class": {
                      "value": "form-item-element form-item-element_checkbox form-item-element_label-html"
                    }
                  }
                }
              }
            }
          }
        },
        "facilities_container": {
          "type": "object",
          "model": false,
          "widget": {
            "name": "container",
            "options": {
              "label": "Доступное оснащение"
            },
            "class": {
              "label": "h2 mrg-b-md",
              "value": "mrg-b-sm"
            }
          },
          "properties": {
            "additional_services": {
              "type": "object",
              "model": false,
              "widget": {
                "name": "container",
                "kind": "container-form-group-with-h3-style"
              },
              "properties": {
                "header-with-button": {
                  "type": "object",
                  "widget": {
                    "name": "container",
                    "options": {
                      "label": "Дополнительные услуги"
                    },
                    "class": {
                      "group": "flex-row p-grid mrg-b-lg mrg-t-0",
                      "label": "h4 p-xs-12 p-md-4 p-xl-3 pdd-tb-0 mrg-md-b-md",
                      "value": "p-xs-12 p-md-8 p-xl-9 pdd-tb-0"
                    }
                  },
                  "properties": {
                    "button": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "icon": "icon-plus",
                          "label": "Добавить услуги"
                        },
                        "events": {
                          "click": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#searchServices",
                                    "data": {}
                                  }
                                },
                                {
                                  "$element-event": {
                                    "event": "keypress-13",
                                    "path": "#searchServices.typeOrName",
                                    "value": true
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectServices",
                                    "value": true
                                  }
                                },
                                {
                                  "$element-option": {
                                    "path": "#selectorServices",
                                    "option": "selection",
                                    "value": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#data.room.additional_services"
                                          }
                                        },
                                        "key": "serviceId"
                                      }
                                    }
                                  }
                                },
                                {
                                  "$populate": {
                                    "path": "#selected-chips",
                                    "data": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#data.room.additional_services"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              ]
                            }
                          }
                        },
                        "class": {
                          "value": "button_link"
                        }
                      }
                    }
                  }
                },
                "additional_services": {
                  "type": "array",
                  "model": "#data.room.additional_services",
                  "widget": {
                    "name": "table",
                    "options": {
                      "selectionKey": "serviceId",
                      "emptyMessage": "Не добавлено информации для отображения",
                      "responsive": false,
                      "first": 0,
                      "lazy": true,
                      "paginator": true,
                      "rows": 10,
                      "rowsPerPageOptions": [
                        10,
                        20,
                        50
                      ],
                      "routerOptions": [
                        "first",
                        "rows"
                      ],
                      "initialFilters": {
                        "$var": {
                          "path": "#data.room.additional_services"
                        }
                      },
                      "sortField": "name",
                      "sortOrder": 1
                    },
                    "class": {
                      "value": "data-table d-block mrg-b-lg"
                    },
                    "events": {
                      "lazyLoad": {
                        "$element-option": {
                          "path": "#data.room.additional_services",
                          "option": "loading",
                          "value": true
                        }
                      }
                    },
                    "subscriptions": {
                      "reload-table": {
                        "$element-event": {
                          "event": "reload",
                          "value": true
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "object",
                    "properties": {
                      "serviceId": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "name": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Наименование"
                          }
                        }
                      },
                      "servicesType": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Тип услуги"
                          }
                        },
                        "properties": {
                          "name": {
                            "type": "string",
                            "widget": {
                              "name": "info"
                            }
                          }
                        }
                      },
                      "unitPrice": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "unitPriceView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Цена (руб.)"
                          }
                        },
                        "properties": {
                          "price": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "formatter": "number:'0.2-2':'ru'",
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.unitPrice"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      },
                      "unit": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Единица измерения"
                          }
                        }
                      },
                      "comment": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Примечание"
                          }
                        }
                      },
                      "actions_column": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Действия"
                          },
                          "class": {
                            "cell": "column_actions"
                          }
                        },
                        "properties": {
                          "actions": {
                            "widget": {
                              "name": "button",
                              "options": {
                                "icon": "icon-trashbin"
                              },
                              "events": {
                                "click": {
                                  "$collection": {
                                    "action": "row-remove"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-autolayout p-jc-center",
                                "value": "button_icon button_icon-shaded"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "equipments": {
              "type": "object",
              "model": false,
              "widget": {
                "name": "container",
                "kind": "container-form-group-with-h3-style"
              },
              "properties": {
                "header-with-button": {
                  "type": "object",
                  "widget": {
                    "name": "container",
                    "options": {
                      "label": "Оборудование"
                    },
                    "class": {
                      "group": "flex-row p-grid mrg-b-lg mrg-t-0",
                      "label": "h4 p-xs-12 p-md-4 p-xl-3 pdd-tb-0 mrg-md-b-md",
                      "value": "p-xs-12 p-md-8 p-xl-9 pdd-tb-0"
                    }
                  },
                  "properties": {
                    "button": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "icon": "icon-plus",
                          "label": "Добавить оборудование"
                        },
                        "events": {
                          "click": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#searchEquipments",
                                    "data": {}
                                  }
                                },
                                {
                                  "$element-event": {
                                    "event": "keypress-13",
                                    "path": "#searchEquipments.typeOrNumber",
                                    "value": true
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectEquipments",
                                    "value": true
                                  }
                                },
                                {
                                  "$element-option": {
                                    "path": "#selectorEquipments",
                                    "option": "selection",
                                    "value": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#data.room.equipments"
                                          }
                                        },
                                        "key": "equipmentId"
                                      }
                                    }
                                  }
                                },
                                {
                                  "$populate": {
                                    "path": "#selected-chips-equipment",
                                    "data": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#data.room.equipments"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              ]
                            }
                          }
                        },
                        "class": {
                          "value": "button_link"
                        }
                      }
                    }
                  }
                },
                "equipments": {
                  "type": "array",
                  "model": "#data.room.equipments",
                  "widget": {
                    "name": "table",
                    "options": {
                      "selectionKey": "equipmentId",
                      "emptyMessage": "Не добавлено информации для отображения",
                      "responsive": false,
                      "first": 0,
                      "lazy": true,
                      "paginator": true,
                      "rows": 10,
                      "rowsPerPageOptions": [
                        10,
                        20,
                        50
                      ],
                      "routerOptions": [
                        "first",
                        "rows"
                      ],
                      "initialFilters": {
                        "$var": {
                          "path": "#data.room.equipments"
                        }
                      },
                      "sortField": "name",
                      "sortOrder": 1
                    },
                    "class": {
                      "value": "data-table d-block mrg-b-lg"
                    },
                    "events": {
                      "lazyLoad": {
                        "$element-option": {
                          "path": "#data.room.equipments",
                          "option": "loading",
                          "value": true
                        }
                      }
                    },
                    "subscriptions": {
                      "reload-table": {
                        "$element-event": {
                          "event": "reload",
                          "value": true
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "object",
                    "properties": {
                      "equipmentId": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "name": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Наименование"
                          }
                        }
                      },
                      "ownerCode": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": true,
                            "label": "Собственник"
                          }
                        },
                        "properties": {
                          "name": {
                            "type": "string",
                            "widget": {
                              "name": "info"
                            }
                          }
                        }
                      },
                      "nomenclatureNumber": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Номенклатурный номер"
                          }
                        }
                      },
                      "unitPrice": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "unitPriceView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Цена (руб.)"
                          }
                        },
                        "properties": {
                          "price": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "formatter": "number:'0.2-2':'ru'",
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.unitPrice"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      },
                      "availableQuantity": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "availableQuantityView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Доступное количество (шт.)"
                          }
                        },
                        "properties": {
                          "quantity": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.availableQuantity"
                                  }
                                },
                                "formatter": "number:'1.0-0':'ru'"
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      },
                      "comment": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Примечание"
                          }
                        }
                      },
                      "actions_column": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Действия"
                          },
                          "class": {
                            "cell": "column_actions"
                          }
                        },
                        "properties": {
                          "actions": {
                            "widget": {
                              "name": "button",
                              "options": {
                                "icon": "icon-trashbin"
                              },
                              "events": {
                                "click": {
                                  "$collection": {
                                    "action": "row-remove"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-autolayout p-jc-center",
                                "value": "button_icon button_icon-shaded"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "furniture": {
              "type": "object",
              "model": false,
              "widget": {
                "name": "container",
                "kind": "container-form-group-with-h3-style"
              },
              "properties": {
                "header-with-button": {
                  "type": "object",
                  "widget": {
                    "name": "container",
                    "options": {
                      "label": "Мебель"
                    },
                    "class": {
                      "group": "flex-row p-grid mrg-b-lg mrg-t-0",
                      "label": "h4 p-xs-12 p-md-4 p-xl-3 pdd-tb-0 mrg-md-b-md",
                      "value": "p-xs-12 p-md-8 p-xl-9 pdd-tb-0"
                    }
                  },
                  "properties": {
                    "button": {
                      "widget": {
                        "name": "button",
                        "options": {
                          "icon": "icon-plus",
                          "label": "Добавить мебель"
                        },
                        "events": {
                          "click": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#searchFurniture",
                                    "data": {}
                                  }
                                },
                                {
                                  "$element-event": {
                                    "event": "keypress-13",
                                    "path": "#searchFurniture.typeOrNumber",
                                    "value": true
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectFurniture",
                                    "value": true
                                  }
                                },
                                {
                                  "$element-option": {
                                    "path": "#selectorFurniture",
                                    "option": "selection",
                                    "value": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#data.room.furniture"
                                          }
                                        },
                                        "key": "furnitureId"
                                      }
                                    }
                                  }
                                },
                                {
                                  "$populate": {
                                    "path": "#selected-chips-furniture",
                                    "data": {
                                      "$array-pluck": {
                                        "array": {
                                          "$var": {
                                            "path": "#data.room.furniture"
                                          }
                                        },
                                        "key": "name"
                                      }
                                    }
                                  }
                                }
                              ]
                            }
                          }
                        },
                        "class": {
                          "value": "button_link"
                        }
                      }
                    }
                  }
                },
                "furniture": {
                  "type": "array",
                  "model": "#data.room.furniture",
                  "widget": {
                    "name": "table",
                    "options": {
                      "selectionKey": "furnitureId",
                      "emptyMessage": "Не добавлено информации для отображения",
                      "responsive": false,
                      "first": 0,
                      "lazy": true,
                      "paginator": true,
                      "rows": 10,
                      "rowsPerPageOptions": [
                        10,
                        20,
                        50
                      ],
                      "routerOptions": [
                        "first",
                        "rows"
                      ],
                      "initialFilters": {
                        "$var": {
                          "path": "#data.room.furniture"
                        }
                      },
                      "sortField": "name",
                      "sortOrder": 1
                    },
                    "class": {
                      "value": "data-table d-block"
                    },
                    "events": {
                      "lazyLoad": {
                        "$element-option": {
                          "path": "#data.room.furniture",
                          "option": "loading",
                          "value": true
                        }
                      }
                    },
                    "subscriptions": {
                      "reload-table": {
                        "$element-event": {
                          "event": "reload",
                          "value": true
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "object",
                    "properties": {
                      "furnitureId": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "name": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Наименование"
                          }
                        }
                      },
                      "ownerCode": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": true,
                            "label": "Собственник"
                          }
                        },
                        "properties": {
                          "name": {
                            "type": "string",
                            "widget": {
                              "name": "info"
                            }
                          }
                        }
                      },
                      "nomenclatureNumber": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Номенклатурный номер"
                          }
                        }
                      },
                      "unitPrice": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "unitPriceView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Цена (руб.)"
                          }
                        },
                        "properties": {
                          "price": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "formatter": "number:'0.2-2':'ru'",
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.unitPrice"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      },
                      "availableQuantity": {
                        "type": "number",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "visible": false
                          }
                        }
                      },
                      "availableQuantityView": {
                        "type": "object",
                        "model": false,
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Доступное количество (шт.)"
                          }
                        },
                        "properties": {
                          "quantity": {
                            "type": "string",
                            "model": false,
                            "widget": {
                              "name": "info",
                              "options": {
                                "viewedValue": {
                                  "$from-context": {
                                    "path": "$rowData.availableQuantity"
                                  }
                                },
                                "formatter": "number:'1.0-0':'ru'"
                              },
                              "class": {
                                "group": "p-text-right",
                                "value": "p-jc-end"
                              }
                            }
                          }
                        }
                      },
                      "comment": {
                        "type": "string",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Примечание"
                          }
                        }
                      },
                      "actions_column": {
                        "type": "object",
                        "widget": {
                          "name": "table-column",
                          "options": {
                            "label": "Действия"
                          },
                          "class": {
                            "cell": "column_actions"
                          }
                        },
                        "properties": {
                          "actions": {
                            "widget": {
                              "name": "button",
                              "options": {
                                "icon": "icon-trashbin"
                              },
                              "events": {
                                "click": {
                                  "$collection": {
                                    "action": "row-remove"
                                  }
                                }
                              },
                              "class": {
                                "group": "p-autolayout p-jc-center",
                                "value": "button_icon button_icon-shaded"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "actions": {
      "type": "object",
      "model": "#actions",
      "widget": {
        "name": "form",
        "class": {
          "group": "form-actions p-field p-grid mrg-t-0",
          "value": "p-jc-xs-end p-autolayout"
        }
      },
      "properties": {
        "button_booking": {
          "widget": {
            "name": "button",
            "options": {
              "label": "Сохранить",
              "visible": {
                "$if": {
                  "condition": {
                    "$empty": {
                      "data": {
                        "$from-context": {
                          "path": "@preload.booking"
                        }
                      }
                    }
                  },
                  "then": false,
                  "else": true
                }
              }
            },
            "events": {
              "click": {
                "$element-option": {
                  "option": "visible",
                  "path": "#modalBooking",
                  "value": true
                }
              }
            },
            "class": {
              "value": "mrg-r-sm"
            }
          }
        },
        "button_add": {
          "widget": {
            "name": "submit-button",
            "options": {
              "label": "Сохранить",
              "visible": {
                "$if": {
                  "condition": {
                    "$empty": {
                      "data": {
                        "$from-context": {
                          "path": "@preload.booking"
                        }
                      }
                    }
                  },
                  "then": true,
                  "else": false
                }
              },
              "clientValidation": true,
              "dataForClientValidation": "/",
              "showClientValidationErrorsForElement": "form",
              "showClientValidationErrorMessage": true,
              "clientValidationErrorMessageSummary": "Ошибка",
              "clientValidationErrorMessageDetail": "Одно или несколько полей заполнены некорректно",
              "workflowAction": "room.edit",
              "workflowObjectId": {
                "$query-params": {
                  "name": "id"
                }
              },
              "dataForSubmit": {
                "$exclude": {
                  "data": {
                    "$var": {
                      "path": "#data.room"
                    }
                  },
                  "exclude": [
                    "room_type"
                  ]
                }
              },
              "showSuccessMessage": true,
              "successMessageSummary": "Редактирование помещения",
              "successMessageDetail": "Данные помещения успешно изменены",
              "urlInCaseOfSuccess": {
                "$replace": {
                  "template": "/cabinet/room/view?id={{id}}",
                  "data": {
                    "id": {
                      "$query-params": {
                        "name": "id"
                      }
                    }
                  }
                }
              },
              "showServerValidationErrorMessage": true,
              "serverValidationErrorMessageSummary": "Редактирование помещения",
              "serverValidationErrorMessageDetail": "Форма содержит ошибки",
              "showOtherErrorMessageSummary": true,
              "otherErrorMessageSummary": "Редактирование помещения",
              "otherErrorMessageDetail": "Непредвиденная ошибка",
              "reloadTable": true,
              "closePopup": false
            },
            "class": {
              "value": "mrg-r-sm"
            }
          }
        },
        "button_cancel": {
          "widget": {
            "name": "button",
            "options": {
              "label": "Отмена"
            },
            "events": {
              "click": {
                "$navigate-by-url": {
                  "url": {
                    "$replace": {
                      "template": "/cabinet/room/view?id={{id}}",
                      "data": {
                        "id": {
                          "$query-params": {
                            "name": "id"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "class": {
              "value": "button_outline mrg-r-0 mrg-b-0"
            }
          }
        }
      }
    }
  }
}
