{
  "@title": "Реестр заявок",
  "type": "object",
  "model": "/",
  "widget": {
    "name": "container"
  },
  "properties": {
    "breadcrumbs": {
      "type": "object",
      "widget": {
        "name": "breadcrumb",
        "mobileItems": [
          {
            "label": "Главная",
            "routerLink": "/cabinet/event/list"
          }
        ],
        "items": [
          {
            "label": "Главная",
            "routerLink": "/cabinet/event/list"
          },
          {
            "label": "Заявки"
          }
        ],
        "class": {
          "group": "p-xs-auto mrg-lg-b-xl mrg-b-md"
        }
      }
    },
    "header": {
      "type": "object",
      "widget": {
        "name": "container",
        "options": {
          "label": "Заявки"
        },
        "class": {
          "group": "p-grid mrg-b-lg mrg-t-0",
          "label": "h1 p-xs-12 p-xl-9 pdd-tb-0",
          "value": "p-xs-12 p-xl-3 pdd-tb-0 p-jc-xl-end p-as-center p-autolayout"
        }
      }
    },
    "search": {
      "model": "#search",
      "type": "object",
      "widget": {
        "name": "container",
        "class": {
          "value": "search-form search-form_expanded search-form_margin form-group_inline p-grid p-fluid"
        },
        "options": {
          "displayNone": false,
          "routerOptions": [
            "displayNone"
          ]
        }
      },
      "properties": {
        "search": {
          "type": "string",
          "validation": [
            {
              "type": "schema",
              "params": {
                "rule": {
                  "<=": {
                    "operand1": {
                      "$length": {
                        "data": {
                          "$if": {
                            "condition": {
                              "$not-empty": {
                                "data": {
                                  "$var": {
                                    "path": "."
                                  }
                                }
                              }
                            },
                            "then": {
                              "$var": {
                                "path": "."
                              }
                            },
                            "else": ""
                          }
                        }
                      }
                    },
                    "operand2": 255
                  }
                }
              },
              "events": [
                "onBackend",
                "onUpdate"
              ]
            }
          ],
          "widget": {
            "name": "input",
            "options": {
              "placeholder": "Наименование мероприятия"
            },
            "class": {
              "actionButtonGroup": "search-form-trigger search-form-trigger_expanded",
              "group": "form-item pdd-b-0 p-xs-12 p-md-6 p-xl-8 p-xxl-10",
              "value": "form-item-element search-form-input"
            }
          }
        },
        "clear-button": {
          "widget": {
            "name": "button",
            "options": {
              "label": "Сбросить"
            },
            "events": {
              "click": [
                {
                  "$populate": {
                    "path": "#search",
                    "data": {}
                  }
                },
                {
                  "$grid": {
                    "action": "lazyLoad",
                    "path": "#data",
                    "filters": {
                      "$var": {
                        "path": "#search"
                      }
                    }
                  }
                }
              ]
            },
            "class": {
              "group": "form-item pdd-b-0 p-xs-6 p-md-3 p-xl-2 p-xxl-1",
              "value": "button_narrow button_outline button_clear"
            }
          }
        },
        "search-button": {
          "widget": {
            "name": "button",
            "options": {
              "label": "Найти"
            },
            "events": {
              "click": [
                {
                  "$grid": {
                    "action": "lazyLoad",
                    "path": "#data",
                    "filters": {
                      "$var": {
                        "path": "#search"
                      }
                    }
                  }
                }
              ]
            },
            "class": {
              "group": "form-item pdd-b-0 p-xs-6 p-md-3 p-xl-2 p-xxl-1",
              "value": "button_pdd-lr-0"
            }
          }
        },
        "type": {
          "type": "any",
          "widget": {
            "name": "multiselect",
            "options": {
              "label": "Тип заявки",
              "placeholder": "Выбрать",
              "optionLabel": "name",
              "valueKey": "code",
              "filter": true,
              "valueOptions": [
                {
                  "code": "cancel",
                  "name": "Отмена мероприятия"
                },
                {
                  "code": "edit_event",
                  "name": "Изменение мероприятия"
                },
                {
                  "code": "edit_cost",
                  "name": "Изменение стоимости мероприятия"
                },
                {
                  "code": "edit_booking",
                  "name": "Изменение брони помещения"
                },
                {
                  "code": "edit_booking_cost",
                  "name": "Изменение стоимости брони помещения"
                },
                {
                  "code": "edit_facilities",
                  "name": "Изменение брони оснащения"
                },
                {
                  "code": "edit_facilities_cost",
                  "name": "Изменение стоимости брони оснащения"
                }
              ]
            },
            "class": {
              "group": "form-item pdd-tb-0 p-xs-12 p-md-6 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        },
        "state": {
          "type": "any",
          "widget": {
            "name": "multiselect",
            "options": {
              "label": "Статус",
              "placeholder": "Выбрать",
              "useEllipsisWhenDisplayFieldOverflows": false,
              "filter": true,
              "showClear": true,
              "optionLabel": "name",
              "dataKey": "code",
              "valueKey": "code",
              "valueOptions": {
                "$workflow-states": {
                  "workflow": "request"
                }
              }
            },
            "class": {
              "group": "form-item pdd-tb-0 p-xs-12 p-md-6 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        },
        "author": {
          "type": "any",
          "widget": {
            "name": "multiselect",
            "options": {
              "label": "Автор",
              "placeholder": "Выбрать",
              "useEllipsisWhenDisplayFieldOverflows": false,
              "filter": true,
              "showClear": true,
              "optionLabel": "fullName",
              "valueKey": "_id",
              "dataKey": "_id",
              "valueOptions": {
                "$fetch-object": {
                  "path": "data.items",
                  "data": {
                    "$api-data": {
                      "query": "user/get_for_dropdown"
                    }
                  }
                }
              }
            },
            "class": {
              "group": "form-item pdd-tb-0 p-xs-12 p-md-6 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        },
        "isAuthor": {
          "type": "boolean",
          "widget": {
            "name": "checkbox",
            "options": {
              "label": " ",
              "optionLabel": "Показать мои заявки"
            },
            "events": {
              "change": {
                "$if": {
                  "condition": {
                    "$var": {
                      "path": "."
                    }
                  },
                  "then": {
                    "$populate": {
                      "path": "#search.author",
                      "data": {
                        "$active-user": {
                          "field": "_id"
                        }
                      }
                    }
                  },
                  "else": {
                    "$populate": {
                      "path": "#search.author",
                      "data": {}
                    }
                  }
                }
              }
            },
            "class": {
              "group": "form-item pdd-t-60 p-xs-12 p-md-3 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        },
        "dateCreateFrom": {
          "type": "date",
          "widget": {
            "name": "calendar",
            "options": {
              "label": "Дата добавления с",
              "timeZone": {
                "$if": {
                  "condition": {
                    "$not-empty": {
                      "data": {
                        "$active-user": {
                          "field": "timezone.offset"
                        }
                      }
                    }
                  },
                  "then": {
                    "$fetch-object": {
                      "path": "1",
                      "data": {
                        "$string-split": {
                          "string": {
                            "$active-user": {
                              "field": "timezone.offset"
                            }
                          },
                          "separator": "UTC"
                        }
                      }
                    }
                  },
                  "else": ""
                }
              }
            },
            "class": {
              "group": "form-item pdd-tb-0 p-xs-12 p-md-3 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        },
        "dateCreateTo": {
          "type": "date",
          "widget": {
            "name": "calendar",
            "options": {
              "label": "по",
              "timeZone": {
                "$if": {
                  "condition": {
                    "$not-empty": {
                      "data": {
                        "$active-user": {
                          "field": "timezone.offset"
                        }
                      }
                    }
                  },
                  "then": {
                    "$fetch-object": {
                      "path": "1",
                      "data": {
                        "$string-split": {
                          "string": {
                            "$active-user": {
                              "field": "timezone.offset"
                            }
                          },
                          "separator": "UTC"
                        }
                      }
                    }
                  },
                  "else": ""
                }
              }
            },
            "class": {
              "group": "form-item pdd-tb-0 p-xs-12 p-md-3 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        },
        "dateAgreementFrom": {
          "type": "date",
          "widget": {
            "name": "calendar",
            "options": {
              "label": "Дата обработки с",
              "timeZone": {
                "$if": {
                  "condition": {
                    "$not-empty": {
                      "data": {
                        "$active-user": {
                          "field": "timezone.offset"
                        }
                      }
                    }
                  },
                  "then": {
                    "$fetch-object": {
                      "path": "1",
                      "data": {
                        "$string-split": {
                          "string": {
                            "$active-user": {
                              "field": "timezone.offset"
                            }
                          },
                          "separator": "UTC"
                        }
                      }
                    }
                  },
                  "else": ""
                }
              }
            },
            "class": {
              "group": "form-item pdd-tb-0 p-xs-12 p-md-3 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        },
        "dateAgreementTo": {
          "type": "date",
          "widget": {
            "name": "calendar",
            "options": {
              "label": "по",
              "timeZone": {
                "$if": {
                  "condition": {
                    "$not-empty": {
                      "data": {
                        "$active-user": {
                          "field": "timezone.offset"
                        }
                      }
                    }
                  },
                  "then": {
                    "$fetch-object": {
                      "path": "1",
                      "data": {
                        "$string-split": {
                          "string": {
                            "$active-user": {
                              "field": "timezone.offset"
                            }
                          },
                          "separator": "UTC"
                        }
                      }
                    }
                  },
                  "else": ""
                }
              }
            },
            "class": {
              "group": "form-item pdd-tb-0 p-xs-12 p-md-3 p-xl-3",
              "label": "form-label form-label_top",
              "value": "form-item-element"
            }
          }
        }
      }
    },
    "table": {
      "value": {
        "$api-table-workflow-data": {
          "model": "#data",
          "query": "request/list",
          "variables": {
            "$graphql-event-variables": {
              "data": {
                "$element-event": {
                  "event": "lazyLoad"
                }
              }
            }
          },
          "errors": {
            "default": {
              "$message": {
                "severity": "error",
                "summary": "Ошибка",
                "detail": "При загрузке данных произошла ошибка, повторите попытку позднее"
              }
            }
          }
        }
      },
      "type": "array",
      "model": "#data",
      "widget": {
        "name": "table-lazy",
        "paginatorLeft": {
          "type": "string",
          "widget": "info",
          "value": {
            "$grid": {
              "action": "rows-per-page",
              "path": "#data"
            }
          }
        },
        "options": {
          "emptyMessage": "Данные не найдены",
          "responsive": false,
          "first": 0,
          "lazy": true,
          "paginator": true,
          "rows": 10,
          "rowsPerPageOptions": [
            10,
            20,
            50
          ],
          "routerOptions": [
            "first",
            "rows"
          ],
          "sortField": "number",
          "sortOrder": -1
        },
        "events": {
          "lazyLoad": {
            "$element-option": {
              "path": "#data",
              "option": "loading",
              "value": true
            }
          }
        },
        "subscriptions": {
          "reload-table": {
            "$element-event": {
              "event": "reload",
              "value": true
            }
          }
        }
      },
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "number": {
            "type": "number",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "numberView": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "№"
              },
              "class": {
                "header": "column_actions"
              }
            },
            "properties": {
              "number": {
                "type": "number",
                "widget": {
                  "name": "info",
                  "class": {
                    "value": "p-jc-center"
                  }
                },
                "value": {
                  "$from-context": {
                    "path": "$rowData.number"
                  }
                }
              }
            }
          },
          "type": {
            "type": "string",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "cancelReason": {
            "type": "string",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "rejectReason": {
            "type": "string",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "typeView": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "Тип заявки"
              }
            },
            "properties": {
              "typeName": {
                "type": "string",
                "widget": {
                  "name": "html"
                },
                "value": {
                  "$replace": {
                    "template": "{{name}}{{additionalInfo}}",
                    "data": {
                      "name": {
                        "$switch": {
                          "condition": {
                            "$from-context": {
                              "path": "$rowData.type"
                            }
                          },
                          "default": "",
                          "cases": [
                            {
                              "value": "cancel",
                              "action": "Отмена мероприятия"
                            },
                            {
                              "value": "edit_event",
                              "action": "Изменение мероприятия"
                            },
                            {
                              "value": "edit_cost",
                              "action": "Изменение стоимости мероприятия"
                            },
                            {
                              "value": "edit_booking",
                              "action": "Изменение брони помещения"
                            },
                            {
                              "value": "edit_booking_cost",
                              "action": "Изменение стоимости брони помещения"
                            },
                            {
                              "value": "edit_facilities",
                              "action": "Изменение брони оснащения"
                            },
                            {
                              "value": "edit_facilities_cost",
                              "action": "Изменение стоимости брони оснащения"
                            }
                          ]
                        }
                      },
                      "additionalInfo": {
                        "$if": {
                          "condition": {
                            "===": {
                              "operand1": {
                                "$from-context": {
                                  "path": "$rowData.type"
                                }
                              },
                              "operand2": "cancel"
                            }
                          },
                          "then": {
                            "$replace": {
                              "template": "<div class=\"text-secondary\"><br/><b>Причина:</b><br/>{{cancelReason}}</div>",
                              "data": {
                                "cancelReason": {
                                  "$encode-tag": {
                                    "string": {
                                      "$from-context": {
                                        "path": "$rowData.cancelReason"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "else": ""
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "eventMain": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            },
            "properties": {
              "id": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              },
              "name": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              },
              "curators": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              }
            }
          },
          "author": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            },
            "properties": {
              "_id": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              },
              "fullName": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              }
            }
          },
          "bookingMain": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            },
            "properties": {
              "id": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              },
              "name": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              }
            }
          },
          "additionalFacilitiesMain": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            },
            "properties": {
              "id": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              },
              "eventId": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              },
              "bookingId": {
                "type": "string",
                "widget": {
                  "name": "hidden"
                }
              },
              "event": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "widget": "hidden"
                  }
                },
                "widget": {
                  "name": "fieldset"
                }
              },
              "booking": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "widget": "hidden"
                  }
                },
                "widget": {
                  "name": "fieldset"
                }
              }
            }
          },
          "eventView": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "Мероприятие/бронь"
              }
            },
            "properties": {
              "nameText": {
                "type": "string",
                "widget": {
                  "name": "info",
                  "options": {
                    "visible": {
                      "$not": {
                        "data": {
                          "$active-user-has-permission": {
                            "permission": "event.view"
                          }
                        }
                      }
                    }
                  }
                },
                "value": {
                  "$switch": {
                    "condition": {
                      "$from-context": {
                        "path": "$rowData.type"
                      }
                    },
                    "default": {},
                    "cases": [
                      {
                        "value": "cancel",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.eventMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_event",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.eventMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_cost",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.eventMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_booking",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.bookingMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_booking_cost",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.bookingMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_facilities",
                        "action": {
                          "$if": {
                            "condition": {
                              "$empty": {
                                "data": {
                                  "$from-context": {
                                    "path": "$rowData.additionalFacilitiesMain.bookingId"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.event.name"
                              }
                            },
                            "else": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.booking.name"
                              }
                            }
                          }
                        }
                      },
                      {
                        "value": "edit_facilities_cost",
                        "action": {
                          "$if": {
                            "condition": {
                              "$empty": {
                                "data": {
                                  "$from-context": {
                                    "path": "$rowData.additionalFacilitiesMain.bookingId"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.event.name"
                              }
                            },
                            "else": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.booking.name"
                              }
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              },
              "nameLink": {
                "type": "string",
                "widget": {
                  "name": "link",
                  "options": {
                    "visible": {
                      "$active-user-has-permission": {
                        "permission": "event.view"
                      }
                    },
                    "routerLink": {
                      "$switch": {
                        "condition": {
                          "$from-context": {
                            "path": "$rowData.type"
                          }
                        },
                        "default": {},
                        "cases": [
                          {
                            "value": "cancel",
                            "action": "/cabinet/event/view"
                          },
                          {
                            "value": "edit_event",
                            "action": "/cabinet/event/view"
                          },
                          {
                            "value": "edit_cost",
                            "action": "/cabinet/event/view"
                          },
                          {
                            "value": "edit_booking",
                            "action": "/cabinet/booking/view"
                          },
                          {
                            "value": "edit_booking_cost",
                            "action": "/cabinet/booking/view"
                          },
                          {
                            "value": "edit_facilities",
                            "action": {
                              "$if": {
                                "condition": {
                                  "$empty": {
                                    "data": {
                                      "$from-context": {
                                        "path": "$rowData.additionalFacilitiesMain.bookingId"
                                      }
                                    }
                                  }
                                },
                                "then": "/cabinet/event/view",
                                "else": "/cabinet/booking/view"
                              }
                            }
                          },
                          {
                            "value": "edit_facilities_cost",
                            "action": {
                              "$if": {
                                "condition": {
                                  "$empty": {
                                    "data": {
                                      "$from-context": {
                                        "path": "$rowData.additionalFacilitiesMain.bookingId"
                                      }
                                    }
                                  }
                                },
                                "then": "/cabinet/event/view",
                                "else": "/cabinet/booking/view"
                              }
                            }
                          }
                        ]
                      }
                    },
                    "queryParams": {
                      "id": {
                        "$switch": {
                          "condition": {
                            "$from-context": {
                              "path": "$rowData.type"
                            }
                          },
                          "default": {},
                          "cases": [
                            {
                              "value": "cancel",
                              "action": {
                                "$from-context": {
                                  "path": "$rowData.eventMain.id"
                                }
                              }
                            },
                            {
                              "value": "edit_event",
                              "action": {
                                "$from-context": {
                                  "path": "$rowData.eventMain.id"
                                }
                              }
                            },
                            {
                              "value": "edit_cost",
                              "action": {
                                "$from-context": {
                                  "path": "$rowData.eventMain.id"
                                }
                              }
                            },
                            {
                              "value": "edit_booking",
                              "action": {
                                "$from-context": {
                                  "path": "$rowData.bookingMain.id"
                                }
                              }
                            },
                            {
                              "value": "edit_booking_cost",
                              "action": {
                                "$from-context": {
                                  "path": "$rowData.bookingMain.id"
                                }
                              }
                            },
                            {
                              "value": "edit_facilities",
                              "action": {
                                "$if": {
                                  "condition": {
                                    "$empty": {
                                      "data": {
                                        "$from-context": {
                                          "path": "$rowData.additionalFacilitiesMain.bookingId"
                                        }
                                      }
                                    }
                                  },
                                  "then": {
                                    "$from-context": {
                                      "path": "$rowData.additionalFacilitiesMain.eventId"
                                    }
                                  },
                                  "else": {
                                    "$from-context": {
                                      "path": "$rowData.additionalFacilitiesMain.bookingId"
                                    }
                                  }
                                }
                              }
                            },
                            {
                              "value": "edit_facilities_cost",
                              "action": {
                                "$if": {
                                  "condition": {
                                    "$empty": {
                                      "data": {
                                        "$from-context": {
                                          "path": "$rowData.additionalFacilitiesMain.bookingId"
                                        }
                                      }
                                    }
                                  },
                                  "then": {
                                    "$from-context": {
                                      "path": "$rowData.additionalFacilitiesMain.eventId"
                                    }
                                  },
                                  "else": {
                                    "$from-context": {
                                      "path": "$rowData.additionalFacilitiesMain.bookingId"
                                    }
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  }
                },
                "value": {
                  "$switch": {
                    "condition": {
                      "$from-context": {
                        "path": "$rowData.type"
                      }
                    },
                    "default": {},
                    "cases": [
                      {
                        "value": "cancel",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.eventMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_event",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.eventMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_cost",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.eventMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_booking",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.bookingMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_booking_cost",
                        "action": {
                          "$from-context": {
                            "path": "$rowData.bookingMain.name"
                          }
                        }
                      },
                      {
                        "value": "edit_facilities",
                        "action": {
                          "$if": {
                            "condition": {
                              "$empty": {
                                "data": {
                                  "$from-context": {
                                    "path": "$rowData.additionalFacilitiesMain.bookingId"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.event.name"
                              }
                            },
                            "else": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.booking.name"
                              }
                            }
                          }
                        }
                      },
                      {
                        "value": "edit_facilities_cost",
                        "action": {
                          "$if": {
                            "condition": {
                              "$empty": {
                                "data": {
                                  "$from-context": {
                                    "path": "$rowData.additionalFacilitiesMain.bookingId"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.event.name"
                              }
                            },
                            "else": {
                              "$from-context": {
                                "path": "$rowData.additionalFacilitiesMain.booking.name"
                              }
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          },
          "curatorsView": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "Автор"
              }
            },
            "properties": {
              "nameText": {
                "type": "string",
                "widget": {
                  "name": "info",
                  "options": {
                    "visible": {
                      "$not": {
                        "data": {
                          "$active-user-has-permission": {
                            "permission": "user.view"
                          }
                        }
                      }
                    }
                  }
                },
                "value": {
                  "$from-context": {
                    "path": "$rowData.author.fullName"
                  }
                }
              },
              "nameLink": {
                "type": "string",
                "widget": {
                  "name": "link",
                  "options": {
                    "visible": {
                      "$active-user-has-permission": {
                        "permission": "user.view"
                      }
                    },
                    "routerLink": "/cabinet/user/view",
                    "queryParams": {
                      "id": {
                        "$from-context": {
                          "path": "$rowData.author._id"
                        }
                      }
                    }
                  }
                },
                "value": {
                  "$from-context": {
                    "path": "$rowData.author.fullName"
                  }
                }
              }
            }
          },
          "createDate": {
            "type": "string",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "createDateView": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "Дата добавления"
              }
            },
            "properties": {
              "date": {
                "type": "string",
                "widget": {
                  "name": "html"
                },
                "value": {
                  "$replace": {
                    "template": "{{0}}",
                    "data": [
                      {
                        "$date-format": {
                          "template": "DD.MM.YYYY",
                          "nameZone": "ETC/GMT+0",
                          "value": {
                            "$from-context": {
                              "path": "$rowData.createDate"
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          },
          "agreementDate": {
            "type": "date",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "agreementDateView": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "Дата обработки"
              }
            },
            "properties": {
              "date": {
                "type": "string",
                "widget": {
                  "name": "html"
                },
                "value": {
                  "$replace": {
                    "template": "{{0}}",
                    "data": [
                      {
                        "$date-format": {
                          "template": "DD.MM.YYYY",
                          "nameZone": "ETC/GMT+0",
                          "value": {
                            "$from-context": {
                              "path": "$rowData.agreementDate"
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          },
          "state": {
            "type": "string",
            "widget": {
              "name": "table-column",
              "options": {
                "visible": false
              }
            }
          },
          "statusName": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "Статус"
              }
            },
            "properties": {
              "state": {
                "type": "string",
                "value": {
                  "$from-context": {
                    "path": "$rowData.state"
                  }
                },
                "widget": {
                  "name": "badge",
                  "options": {
                    "displayMapping": [
                      {
                        "color": "badge_error",
                        "label": "Отклонена",
                        "value": "rejected"
                      },
                      {
                        "color": "badge_warning",
                        "label": "На согласовании",
                        "value": "new"
                      },
                      {
                        "color": "badge_warning",
                        "label": "На совместном согласовании",
                        "value": "on_approve"
                      },
                      {
                        "color": "badge_active",
                        "label": "Согласована",
                        "value": "accepted"
                      }
                    ]
                  }
                }
              },
              "additionalInfo": {
                "type": "string",
                "value": {
                  "$if": {
                    "condition": {
                      "===": {
                        "operand1": {
                          "$from-context": {
                            "path": "$rowData.state"
                          }
                        },
                        "operand2": "rejected"
                      }
                    },
                    "then": {
                      "$replace": {
                        "template": "<div class=\"text-secondary mrg-t-xs\"><b>Причина:</b><br/>{{reason}}</div>",
                        "data": {
                          "reason": {
                            "$encode-tag": {
                              "string": {
                                "$from-context": {
                                  "path": "$rowData.rejectReason"
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "else": ""
                  }
                },
                "widget": {
                  "name": "html",
                  "class": {
                    "value": "p-flex-column p-ai-start"
                  }
                }
              }
            }
          },
          "actions_column": {
            "type": "object",
            "widget": {
              "name": "table-column",
              "options": {
                "label": "Действия"
              },
              "class": {
                "header": "column_actions",
                "cell": "column_actions"
              }
            },
            "properties": {
              "actions": {
                "type": "array",
                "model": "actions",
                "widget": {
                  "name": "actions-button",
                  "items": {
                    "$subs": {
                      "path": "#data[].actions"
                    }
                  }
                },
                "items": {
                  "type": "action",
                  "properties": {
                    "id": {
                      "type": "string",
                      "widget": "hidden"
                    },
                    "title": {
                      "type": "string",
                      "widget": "hidden"
                    },
                    "icon": {
                      "type": "string",
                      "widget": "hidden"
                    },
                    "url": {
                      "type": "string",
                      "widget": "hidden"
                    },
                    "routerLink": {
                      "type": "string",
                      "widget": "hidden"
                    },
                    "popup": {
                      "type": "string",
                      "widget": "hidden"
                    },
                    "hidden": {
                      "type": "string",
                      "widget": "hidden"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
