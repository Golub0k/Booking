{
  "@title": "Добавление группы мероприятий",
  "type": "object",
  "widget": {
    "name": "container"
  },
  "properties": {
    "breadcrumbs": {
      "type": "object",
      "widget": {
        "name": "breadcrumb",
        "mobileItems": [
          {
            "label": "Реестр групп мероприятий",
            "routerLink": "/cabinet/event_group/list"
          }
        ],
        "items": [
          {
            "label": "Главная",
            "routerLink": "/cabinet/event/list"
          },
          {
            "label": "Реестр групп мероприятий",
            "routerLink": "/cabinet/event_group/list"
          },
          {
            "label": "Добавление группы мероприятий"
          }
        ],
        "class": {
          "group": "p-xs-auto mrg-lg-b-xl mrg-b-md"
        }
      }
    },
    "form": {
      "type": "object",
      "model": "#data",
      "widget": {
        "name": "form",
        "options": {
          "label": "Добавление группы мероприятий"
        },
        "class": {
          "label": "h1 mrg-b-lg d-block",
          "value": "mrg-b-xl d-block"
        }
      },
      "properties": {
        "mainInfo": {
          "type": "object",
          "model": false,
          "widget": {
            "name": "container",
            "options": {
              "emptyText": "Не указано",
              "label": "Общие данные"
            },
            "class": {
              "group": "form-section",
              "label": "h2 mrg-b-xl"
            }
          },
          "properties": {
            "name": {
              "type": "string",
              "widget": {
                "name": "input",
                "options": {
                  "label": "Наименование группы"
                },
                "kind": "input-text-input-required-style"
              },
              "validation": [
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "$not-empty": {
                        "data": {
                          "$var": {
                            "path": "."
                          }
                        }
                      }
                    },
                    "message": "Поле обязательно для заполнения"
                  },
                  "events": [
                    "onBackend",
                    "onUpdate"
                  ]
                },
                {
                  "type": "schema",
                  "params": {
                    "rule": {
                      "===": {
                        "operand1": 0,
                        "operand2": {
                          "$fetch-object": {
                            "path": "data.count",
                            "data": {
                              "$api-data": {
                                "query": "event_group/name_exists",
                                "variables": {
                                  "name": {
                                    "$var": {
                                      "path": "."
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "message": "Группа с таким наименованием уже добавлена в Систему"
                  },
                  "events": [
                    "onBackend"
                  ]
                }
              ]
            },
            "comment": {
              "type": "string",
              "widget": {
                "name": "textarea",
                "options": {
                  "label": "Комментарий"
                },
                "kind": "textarea-text-input-style"
              }
            },
            "eventArr": {
              "type": "array",
              "widget": {
                "name": "hidden"
              },
              "items": {
                "type": "object",
                "properties": {
                  "eventId": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "eventList": {
          "type": "object",
          "model": false,
          "widget": {
            "name": "container"
          },
          "properties": {
            "header-with-button": {
              "type": "object",
              "widget": {
                "name": "container",
                "options": {
                  "label": "Мероприятия"
                },
                "class": {
                  "group": "flex-row p-grid mrg-b-lg mrg-t-0",
                  "label": "h2 p-xs-12 p-md-4 p-xl-3 pdd-tb-0 mrg-md-b-md",
                  "value": "p-xs-12 p-md-8 p-xl-9 pdd-tb-0"
                }
              },
              "properties": {
                "button": {
                  "widget": {
                    "name": "button",
                    "options": {
                      "icon": "icon-plus",
                      "label": "Добавить мероприятия"
                    },
                    "class": {
                      "value": "button_link"
                    },
                    "events": {
                      "click": {
                        "$waterfall": {
                          "arrayFunctions": [
                            {
                              "$populate": {
                                "path": "#searchEvents",
                                "data": {}
                              }
                            },
                            {
                              "$element-event": {
                                "event": "keypress-13",
                                "path": "#searchEvents.search",
                                "value": true
                              }
                            },
                            {
                              "$element-option": {
                                "option": "visible",
                                "path": "#modalSelectEvents",
                                "value": true
                              }
                            },
                            {
                              "$element-option": {
                                "path": "#selectorEvents",
                                "option": "selection",
                                "value": {
                                  "$array-pluck": {
                                    "array": {
                                      "$var": {
                                        "path": "#data.events"
                                      }
                                    },
                                    "key": "eventId"
                                  }
                                }
                              }
                            },
                            {
                              "$populate": {
                                "path": "#selected-chips-event",
                                "data": {
                                  "$array-pluck": {
                                    "array": {
                                      "$var": {
                                        "path": "#data.events"
                                      }
                                    },
                                    "key": "name"
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  }
                }
              }
            },
            "events": {
              "type": "array",
              "model": "#data.events",
              "value": {
                "$fetch-object": {
                  "path": "data.pagination.items",
                  "data": {
                    "$api-data": {
                      "query": "event/list_for_add_group",
                      "variables": {
                        "eventId": {
                          "$if": {
                            "condition": {
                              "$not-empty": {
                                "data": {
                                  "$subs": {
                                    "path": "#data.eventArr"
                                  }
                                }
                              }
                            },
                            "then": {
                              "$array-pluck": {
                                "array": {
                                  "$var": {
                                    "path": "#data.eventArr"
                                  }
                                },
                                "key": "eventId"
                              }
                            },
                            "else": {
                              "$active-user": {
                                "field": "_id"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "widget": {
                "name": "table",
                "options": {
                  "selectionKey": "eventId",
                  "emptyMessage": "Данные не найдены"
                },
                "class": {
                  "value": "data-table d-block mrg-b-lg"
                }
              },
              "items": {
                "type": "object",
                "properties": {
                  "eventId": {
                    "type": "string",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "visible": false
                      }
                    }
                  },
                  "number": {
                    "type": "string",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Номер"
                      },
                      "class": {
                        "header": "column_actions",
                        "cell": "column_actions"
                      }
                    }
                  },
                  "name": {
                    "type": "string",
                    "widget": {
                      "name": "hidden",
                      "options": {
                        "visible": false
                      }
                    }
                  },
                  "nameView": {
                    "type": "object",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Наименование мероприятия"
                      }
                    },
                    "properties": {
                      "nameText": {
                        "type": "string",
                        "widget": {
                          "name": "info",
                          "options": {
                            "visible": {
                              "$not": {
                                "data": {
                                  "$active-user-has-permission": {
                                    "permission": "event.view"
                                  }
                                }
                              }
                            }
                          }
                        },
                        "value": {
                          "$from-context": {
                            "path": "$rowData.name"
                          }
                        }
                      },
                      "nameLink": {
                        "type": "string",
                        "widget": {
                          "name": "link",
                          "options": {
                            "target": "_blank",
                            "routerLink": "/cabinet/event/view",
                            "queryParams": {
                              "id": {
                                "$from-context": {
                                  "path": "$rowData.eventId"
                                }
                              }
                            },
                            "visible": {
                              "$active-user-has-permission": {
                                "permission": "event.view"
                              }
                            }
                          }
                        },
                        "value": {
                          "$from-context": {
                            "path": "$rowData.name"
                          }
                        }
                      }
                    }
                  },
                  "organizers": {
                    "type": "array",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Организатор"
                      }
                    },
                    "items": {
                      "type": "object",
                      "properties": {
                        "partner": {
                          "type": "object",
                          "properties": {
                            "partnerId": {
                              "type": "string",
                              "widget": "hidden"
                            },
                            "name": {
                              "type": "string",
                              "widget": "hidden"
                            },
                            "nameText": {
                              "type": "string",
                              "widget": {
                                "name": "info",
                                "options": {
                                  "visible": {
                                    "$not": {
                                      "data": {
                                        "$active-user-has-permission": {
                                          "permission": "partner.view"
                                        }
                                      }
                                    }
                                  }
                                }
                              },
                              "value": {
                                "$subs": {
                                  "path": "#data.events[].organizers[].partner.name"
                                }
                              }
                            },
                            "nameLink": {
                              "type": "string",
                              "widget": {
                                "name": "html",
                                "options": {
                                  "visible": {
                                    "$active-user-has-permission": {
                                      "permission": "partner.view"
                                    }
                                  }
                                }
                              },
                              "value": {
                                "$replace": {
                                  "template": "<a href=\"/cabinet/partner/view/?id={{id}}\" target=\"_blank\">{{linkName}}</a>",
                                  "data": {
                                    "id": {
                                      "$subs": {
                                        "path": "#data.events[].organizers[].partner.partnerId"
                                      }
                                    },
                                    "linkName": {
                                      "$subs": {
                                        "path": "#data.events[].organizers[].partner.name"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "widget": {
                            "name": "fieldset"
                          }
                        }
                      },
                      "widget": {
                        "name": "fieldset"
                      }
                    }
                  },
                  "state": {
                    "type": "string",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "visible": false
                      }
                    }
                  },
                  "statusName": {
                    "type": "object",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Статус"
                      }
                    },
                    "properties": {
                      "state": {
                        "type": "string",
                        "value": {
                          "$from-context": {
                            "path": "$rowData.state"
                          }
                        },
                        "widget": {
                          "name": "badge",
                          "options": {
                            "displayMapping": [
                              {
                                "color": "badge_default",
                                "label": "Черновик",
                                "value": "draft"
                              },
                              {
                                "color": "badge_default",
                                "label": "Предварительная бронь",
                                "value": "pre_booking"
                              },
                              {
                                "color": "badge_warning",
                                "label": "Получен запрос",
                                "value": "requested"
                              },
                              {
                                "color": "badge_custom_orange",
                                "label": "Получено ТЗ",
                                "value": "task_received"
                              },
                              {
                                "color": "badge_active",
                                "label": "Согласована смета",
                                "value": "agreed"
                              },
                              {
                                "color": "badge_accent",
                                "label": "Пройден check-in",
                                "value": "check_in"
                              },
                              {
                                "color": "badge_canceled",
                                "label": "Пройден check-out",
                                "value": "check_out"
                              },
                              {
                                "color": "badge_error",
                                "label": "Отменено",
                                "value": "canceled"
                              }
                            ]
                          }
                        }
                      }
                    }
                  },
                  "actions_column": {
                    "type": "object",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Действия"
                      },
                      "class": {
                        "header": "column_actions column_actions_fixed",
                        "cell": "column_actions"
                      }
                    },
                    "properties": {
                      "actions": {
                        "widget": {
                          "name": "button",
                          "options": {
                            "icon": "icon-trashbin"
                          },
                          "events": {
                            "click": {
                              "$waterfall": {
                                "arrayFunctions": [
                                  {
                                    "$populate": {
                                      "path": "#data.eventArr",
                                      "data": {
                                        "$array-filter": {
                                          "array": {
                                            "$var": {
                                              "path": "#data.eventArr"
                                            }
                                          },
                                          "filter": {
                                            "!==": {
                                              "operand1": {
                                                "$from-context": {
                                                  "path": "$rowData.eventId"
                                                }
                                              },
                                              "operand2": {
                                                "$from-context": {
                                                  "path": "$data.eventId"
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  },
                                  {
                                    "$collection": {
                                      "action": "row-remove"
                                    }
                                  }
                                ]
                              }
                            }
                          },
                          "class": {
                            "group": "p-autolayout p-jc-center",
                            "value": "button_icon button_icon-shaded"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "actions": {
          "type": "object",
          "widget": {
            "name": "container",
            "class": {
              "group": "form-actions mrg-t-lg",
              "value": "p-jc-xl-end p-autolayout"
            }
          },
          "properties": {
            "add": {
              "widget": {
                "name": "submit-button",
                "options": {
                  "label": "Добавить",
                  "clientValidation": true,
                  "dataForClientValidation": "/",
                  "showClientValidationErrorsForElement": "form",
                  "showClientValidationErrorMessage": true,
                  "clientValidationErrorMessageSummary": "Ошибка",
                  "clientValidationErrorMessageDetail": "Одно или несколько полей заполнены некорректно",
                  "workflowAction": "event_group.add",
                  "workflowObjectId": {
                    "$query-params": {
                      "name": "id"
                    }
                  },
                  "dataForSubmit": {
                    "$var": {
                      "path": "#data"
                    }
                  },
                  "showSuccessMessage": true,
                  "successMessageSummary": "Добавление группы мероприятий",
                  "successMessageDetail": "Группа мероприятий успешно добавлена",
                  "urlInCaseOfSuccess": "/cabinet/event_group/list",
                  "showServerValidationErrorMessage": true,
                  "serverValidationErrorMessageSummary": "Добавление группы мероприятий",
                  "serverValidationErrorMessageDetail": "Одно или несколько полей заполнены некорректно",
                  "showOtherErrorMessageSummary": true,
                  "otherErrorMessageSummary": "Добавление группы мероприятий",
                  "otherErrorMessageDetail": "Непредвиденная ошибка",
                  "reloadTable": true,
                  "closePopup": false
                },
                "class": {
                  "value": "mrg-r-sm"
                }
              }
            },
            "cancel": {
              "widget": {
                "name": "button",
                "options": {
                  "label": "Отмена"
                },
                "events": {
                  "click": {
                    "$navigate": {
                      "commands": [
                        "/cabinet/event_group/list"
                      ]
                    }
                  }
                },
                "class": {
                  "value": "button_outline mrg-r-0 mrg-b-0"
                }
              }
            }
          }
        }
      }
    },
    "selectEvents": {
      "type": "object",
      "model": "#modalSelectEvents",
      "widget": {
        "name": "dialog",
        "options": {
          "visible": false,
          "closable": true
        }
      },
      "properties": {
        "content": {
          "type": "object",
          "widget": {
            "name": "container"
          },
          "properties": {
            "header": {
              "type": "string",
              "widget": {
                "name": "container",
                "options": {
                  "label": "Выбор мероприятий"
                },
                "kind": "container-popup-with-h1-no-form-collapsed-style"
              }
            },
            "search": {
              "type": "object",
              "model": "#searchEvents",
              "widget": {
                "name": "container",
                "class": {
                  "value": "search-form search-form_collapsed search-form_margin form-group_inline p-grid p-fluid pdd-b-10"
                },
                "options": {
                  "displayNone": false,
                  "routerOptions": [
                    "displayNone"
                  ]
                }
              },
              "properties": {
                "search": {
                  "type": "string",
                  "validation": [
                    {
                      "type": "schema",
                      "params": {
                        "rule": "$ref:rule-validation:snippets/validation/checks/length-255"
                      },
                      "events": [
                        "onBackend",
                        "onUpdate"
                      ]
                    }
                  ],
                  "widget": {
                    "name": "input-group-button",
                    "options": {
                      "placeholder": "Наименование, номер мероприятия",
                      "actionButtonLabel": "Найти",
                      "actionButtonIconMobile": "icon-search",
                      "enableClearButton": true
                    },
                    "events": {
                      "actionButtonClick": {
                        "$grid": {
                          "action": "lazyLoad",
                          "path": "#selectorEvents",
                          "filters": {
                            "$var": {
                              "path": "#searchEvents"
                            }
                          }
                        }
                      },
                      "keypress-13": {
                        "$grid": {
                          "action": "lazyLoad",
                          "path": "#selectorEvents",
                          "filters": {
                            "$var": {
                              "path": "#searchEvents"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "selected-count": {
              "type": "string",
              "model": false,
              "widget": {
                "name": "html",
                "class": {
                  "value": "mrg-b-xs"
                }
              },
              "value": {
                "$replace": {
                  "template": "<p>Выбрано мероприятий: {{0}}</p>",
                  "data": [
                    {
                      "$if": {
                        "condition": {
                          "$not-empty": {
                            "data": {
                              "$element-option": {
                                "option": "selection$",
                                "path": "#selectorEvents"
                              }
                            }
                          }
                        },
                        "then": {
                          "$length": {
                            "data": {
                              "$element-option": {
                                "option": "selection$",
                                "path": "#selectorEvents"
                              }
                            }
                          }
                        },
                        "else": 0
                      }
                    }
                  ]
                }
              }
            },
            "selected-chips-event": {
              "type": "array",
              "items": {
                "type": "string",
                "widget": "info"
              },
              "model": "#selected-chips-event",
              "widget": {
                "name": "chips",
                "class": {
                  "value": "chips-invite-suppliers mrg-b-sm"
                },
                "options": {
                  "onlyRemove": true,
                  "allowDuplicate": false,
                  "disabled": true
                }
              },
              "value": {
                "$if": {
                  "condition": {
                    "$not-empty": {
                      "data": {
                        "$subs": {
                          "path": "#data.events"
                        }
                      }
                    }
                  },
                  "then": {
                    "$array-pluck": {
                      "array": {
                        "$var": {
                          "path": "#data.events"
                        }
                      },
                      "key": "name"
                    }
                  },
                  "else": []
                }
              }
            },
            "table": {
              "value": {
                "$api-table-workflow-data": {
                  "model": "#selectorEvents",
                  "query": "event/list_for_add_group",
                  "variables": {
                    "$graphql-event-variables": {
                      "data": {
                        "$element-event": {
                          "event": "lazyLoad"
                        }
                      }
                    }
                  },
                  "errors": {
                    "default": {
                      "$message": {
                        "severity": "error",
                        "summary": "Ошибка",
                        "detail": "При загрузке данных произошла ошибка, повторите попытку позднее"
                      }
                    }
                  }
                }
              },
              "type": "array",
              "model": "#selectorEvents",
              "widget": {
                "name": "table-lazy",
                "options": {
                  "selectionMode": "multiple",
                  "selectionField": "selected",
                  "selectionKey": "eventId",
                  "first": 0,
                  "rows": 10,
                  "lazy": true,
                  "paginator": true,
                  "rowsPerPageOptions": [
                    10,
                    20,
                    50
                  ],
                  "routerOptions": [
                    "first",
                    "rows"
                  ],
                  "sortField": "number",
                  "sortOrder": -1
                },
                "class": {
                  "value": "data-table d-block mrg-b-lg"
                },
                "events": {
                  "lazyLoad": {
                    "$element-option": {
                      "path": "#selectorEvents",
                      "option": "loading",
                      "value": true
                    }
                  },
                  "onRowSelect": {
                    "$populate": {
                      "path": "#selected-chips-event",
                      "data": {
                        "$array-push": {
                          "array": {
                            "$var": {
                              "path": "#selected-chips-event"
                            }
                          },
                          "data": {
                            "$from-context": {
                              "path": "$event.event.value.name"
                            }
                          }
                        }
                      }
                    }
                  },
                  "onRowUnselect": {
                    "$populate": {
                      "path": "#selected-chips-event",
                      "data": {
                        "$array-filter": {
                          "array": {
                            "$var": {
                              "path": "#selected-chips-event"
                            }
                          },
                          "filter": {
                            "!==": {
                              "operand1": {
                                "$from-context": {
                                  "path": "$data"
                                }
                              },
                              "operand2": {
                                "$from-context": {
                                  "path": "$event.event.value.name"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  },
                  "onHeaderCheckboxToggle": {
                    "$if": {
                      "condition": {
                        "===": {
                          "operand1": {
                            "$from-context": {
                              "path": "$event.event"
                            }
                          },
                          "operand2": true
                        }
                      },
                      "then": {
                        "$populate": {
                          "path": "#selected-chips-event",
                          "data": {
                            "$apply-func": {
                              "func": "return [...new Set([...chipsArr, ...currPageCurators])]",
                              "args": {
                                "chipsArr": {
                                  "$var": {
                                    "path": "#selected-chips-event"
                                  }
                                },
                                "currPageCurators": {
                                  "$array-pluck": {
                                    "array": {
                                      "$var": {
                                        "path": "#selectorEvents"
                                      }
                                    },
                                    "key": "name"
                                  }
                                }
                              }
                            }
                          }
                        }
                      },
                      "else": {
                        "$populate": {
                          "path": "#selected-chips-event",
                          "data": {
                            "$apply-func": {
                              "func": "return chipsArr.filter( function( el ) { return currPageCurators.indexOf( el ) < 0; } )",
                              "args": {
                                "chipsArr": {
                                  "$var": {
                                    "path": "#selected-chips-event"
                                  }
                                },
                                "currPageCurators": {
                                  "$array-pluck": {
                                    "array": {
                                      "$var": {
                                        "path": "#selectorEvents"
                                      }
                                    },
                                    "key": "name"
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "subscriptions": {
                  "reload-table": {
                    "$element-event": {
                      "event": "reload",
                      "value": true
                    }
                  }
                }
              },
              "items": {
                "type": "object",
                "properties": {
                  "selected": {
                    "type": "boolean",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "visible": false
                      }
                    }
                  },
                  "eventId": {
                    "type": "string",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "visible": false
                      }
                    }
                  },
                  "number": {
                    "type": "string",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Номер"
                      },
                      "class": {
                        "header": "column_actions",
                        "cell": "column_actions"
                      }
                    }
                  },
                  "name": {
                    "type": "string",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Наименование мероприятия"
                      }
                    }
                  },
                  "organizers": {
                    "type": "array",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "visible": false
                      }
                    },
                    "items": {
                      "type": "object",
                      "properties": {
                        "partner": {
                          "type": "object",
                          "properties": {
                            "partnerId": {
                              "type": "string",
                              "widget": "hidden"
                            },
                            "name": {
                              "type": "string",
                              "widget": "hidden"
                            }
                          },
                          "widget": {
                            "name": "fieldset"
                          }
                        }
                      },
                      "widget": {
                        "name": "fieldset"
                      }
                    }
                  },
                  "organizersView": {
                    "type": "object",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Организатор"
                      }
                    },
                    "properties": {
                      "organizers": {
                        "type": "array",
                        "widget": {
                          "name": "info",
                          "options": {
                            "separator": "<br>",
                            "asList": "true",
                            "viewedValue": {
                              "$array-map": {
                                "array": {
                                  "$subs": {
                                    "path": "#selectorEvents[].organizers"
                                  }
                                },
                                "map": {
                                  "$from-context": {
                                    "path": "$data.partner.name"
                                  }
                                }
                              }
                            }
                          }
                        },
                        "items": {
                          "type": "object",
                          "properties": {
                            "partner": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "widget": "info"
                                }
                              },
                              "widget": {
                                "name": "fieldset"
                              }
                            }
                          },
                          "widget": {
                            "name": "fieldset"
                          }
                        }
                      }
                    }
                  },
                  "state": {
                    "type": "string",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "visible": false
                      }
                    }
                  },
                  "statusName": {
                    "type": "object",
                    "widget": {
                      "name": "table-column",
                      "options": {
                        "label": "Статус"
                      }
                    },
                    "properties": {
                      "state": {
                        "type": "string",
                        "value": {
                          "$from-context": {
                            "path": "$rowData.state"
                          }
                        },
                        "widget": {
                          "name": "badge",
                          "options": {
                            "displayMapping": [
                              {
                                "color": "badge_default",
                                "label": "Черновик",
                                "value": "draft"
                              },
                              {
                                "color": "badge_default",
                                "label": "Предварительная бронь",
                                "value": "pre_booking"
                              },
                              {
                                "color": "badge_warning",
                                "label": "Получен запрос",
                                "value": "requested"
                              },
                              {
                                "color": "badge_custom_orange",
                                "label": "Получено ТЗ",
                                "value": "task_received"
                              },
                              {
                                "color": "badge_active",
                                "label": "Согласована смета",
                                "value": "agreed"
                              },
                              {
                                "color": "badge_accent",
                                "label": "Пройден check-in",
                                "value": "check_in"
                              },
                              {
                                "color": "badge_canceled",
                                "label": "Пройден check-out",
                                "value": "check_out"
                              },
                              {
                                "color": "badge_error",
                                "label": "Отменено",
                                "value": "canceled"
                              }
                            ]
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "actions": {
              "type": "object",
              "widget": {
                "name": "container",
                "class": {
                  "group": "form-actions p-field p-grid mrg-t-lg",
                  "value": "p-jc-xs-end p-autolayout"
                }
              },
              "properties": {
                "save": {
                  "widget": {
                    "name": "button",
                    "options": {
                      "label": "Добавить выбранные"
                    },
                    "events": {
                      "click": {
                        "$if": {
                          "condition": {
                            "$not-empty": {
                              "data": {
                                "$element-option": {
                                  "path": "#selectorEvents",
                                  "option": "selection"
                                }
                              }
                            }
                          },
                          "then": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#data.eventArr",
                                    "data": {
                                      "$fetch-object": {
                                        "path": "data.pagination.items",
                                        "data": {
                                          "$api-data": {
                                            "query": "event/list_for_add_group",
                                            "variables": {
                                              "eventId": {
                                                "$element-option": {
                                                  "path": "#selectorEvents",
                                                  "option": "selection"
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                },
                                {
                                  "$populate": {
                                    "path": "#data.eventArr",
                                    "data": {
                                      "$fetch-object": {
                                        "path": "data.pagination.items",
                                        "data": {
                                          "$api-data": {
                                            "query": "event/list_for_add_group",
                                            "id": {
                                              "$query-params": {
                                                "name": "id"
                                              }
                                            },
                                            "variables": {
                                              "eventId": {
                                                "$element-option": {
                                                  "path": "#selectorEvents",
                                                  "option": "selection"
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectEvents",
                                    "value": false
                                  }
                                }
                              ]
                            }
                          },
                          "else": {
                            "$waterfall": {
                              "arrayFunctions": [
                                {
                                  "$populate": {
                                    "path": "#data.eventArr",
                                    "data": {}
                                  }
                                },
                                {
                                  "$populate": {
                                    "path": "#data.events",
                                    "data": {}
                                  }
                                },
                                {
                                  "$element-option": {
                                    "option": "visible",
                                    "path": "#modalSelectEvents",
                                    "value": false
                                  }
                                }
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "cancel": {
                  "widget": {
                    "name": "button",
                    "options": {
                      "label": "Отмена"
                    },
                    "events": {
                      "click": {
                        "$element-option": {
                          "option": "visible",
                          "path": "#modalSelectEvents",
                          "value": false
                        }
                      }
                    },
                    "class": {
                      "group": "form-item pdd-b-0 p-xs-6 p-md-3 p-xl-2 p-d-flex p-ai-end",
                      "value": "button_outline "
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
